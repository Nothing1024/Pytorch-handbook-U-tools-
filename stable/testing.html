<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   torch.testing — PyTorch 1.12 documentation
  </title>
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="module-torch.testing">
         <span id="torch-testing">
         </span>
         <h1>
          torch.testing
          <a class="headerlink" href="#module-torch.testing" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py function">
          <dt id="torch.testing.assert_close">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.testing.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             assert_close
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              actual
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              expected
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="o">
             <span class="pre">
              *
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              allow_subclasses
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              rtol
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              atol
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              equal_nan
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              check_device
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              check_dtype
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              check_layout
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              check_stride
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              msg
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="_modules/torch/testing/_comparison.html#assert_close">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.testing.assert_close" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Asserts that
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            are close.
           </p>
           <p>
            If
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            are strided, non-quantized, real-valued, and finite, they are considered close if
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mo stretchy="false">
                   ∣
                  </mo>
                  <mtext>
                   actual
                  </mtext>
                  <mo>
                   −
                  </mo>
                  <mtext>
                   expected
                  </mtext>
                  <mo stretchy="false">
                   ∣
                  </mo>
                  <mo>
                   ≤
                  </mo>
                  <mtext mathvariant="monospace">
                   atol
                  </mtext>
                  <mo>
                   +
                  </mo>
                  <mtext mathvariant="monospace">
                   rtol
                  </mtext>
                  <mo>
                   ⋅
                  </mo>
                  <mo stretchy="false">
                   ∣
                  </mo>
                  <mtext>
                   expected
                  </mtext>
                  <mo stretchy="false">
                   ∣
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \lvert \text{actual} - \text{expected} \rvert \le \texttt{atol} + \texttt{rtol} \cdot \lvert \text{expected} \rvert
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:1em;vertical-align:-0.25em;">
                </span>
                <span class="mopen">
                 ∣
                </span>
                <span class="mord text">
                 <span class="mord">
                  actual
                 </span>
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
                <span class="mbin">
                 −
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1em;vertical-align:-0.25em;">
                </span>
                <span class="mord text">
                 <span class="mord">
                  expected
                 </span>
                </span>
                <span class="mclose">
                 ∣
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
                <span class="mrel">
                 ≤
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:0.6944em;vertical-align:-0.0833em;">
                </span>
                <span class="mord text">
                 <span class="mord texttt">
                  atol
                 </span>
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
                <span class="mbin">
                 +
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:0.6111em;">
                </span>
                <span class="mord text">
                 <span class="mord texttt">
                  rtol
                 </span>
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
                <span class="mbin">
                 ⋅
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1em;vertical-align:-0.25em;">
                </span>
                <span class="mopen">
                 ∣
                </span>
                <span class="mord text">
                 <span class="mord">
                  expected
                 </span>
                </span>
                <span class="mclose">
                 ∣
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            Non-finite values (
            <code class="docutils literal notranslate">
             <span class="pre">
              -inf
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              inf
             </span>
            </code>
            ) are only considered close if and only if they are equal.
            <code class="docutils literal notranslate">
             <span class="pre">
              NaN
             </span>
            </code>
            ’s are
only considered equal to each other if
            <code class="docutils literal notranslate">
             <span class="pre">
              equal_nan
             </span>
            </code>
            is
            <code class="docutils literal notranslate">
             <span class="pre">
              True
             </span>
            </code>
            .
           </p>
           <p>
            In addition, they are only considered close if they have the same
-
            <a class="reference internal" href="generated/torch.Tensor.device.html#torch.Tensor.device" title="torch.Tensor.device">
             <code class="xref py py-attr docutils literal notranslate">
              <span class="pre">
               device
              </span>
             </code>
            </a>
            (if
            <code class="docutils literal notranslate">
             <span class="pre">
              check_device
             </span>
            </code>
            is
            <code class="docutils literal notranslate">
             <span class="pre">
              True
             </span>
            </code>
            ),
-
            <code class="docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            (if
            <code class="docutils literal notranslate">
             <span class="pre">
              check_dtype
             </span>
            </code>
            is
            <code class="docutils literal notranslate">
             <span class="pre">
              True
             </span>
            </code>
            ),
-
            <code class="docutils literal notranslate">
             <span class="pre">
              layout
             </span>
            </code>
            (if
            <code class="docutils literal notranslate">
             <span class="pre">
              check_layout
             </span>
            </code>
            is
            <code class="docutils literal notranslate">
             <span class="pre">
              True
             </span>
            </code>
            ), and
- stride (if
            <code class="docutils literal notranslate">
             <span class="pre">
              check_stride
             </span>
            </code>
            is
            <code class="docutils literal notranslate">
             <span class="pre">
              True
             </span>
            </code>
            ).
If either
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            or
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            is a meta tensor, only the attribute checks will be performed.
           </p>
           <p>
            If
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            are sparse (either having COO, CSR, CSC, BSR, or BSC layout), their strided members are
checked individually. Indices, namely
            <code class="docutils literal notranslate">
             <span class="pre">
              indices
             </span>
            </code>
            for COO,
            <code class="docutils literal notranslate">
             <span class="pre">
              crow_indices
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              col_indices
             </span>
            </code>
            for CSR and BSR,
or
            <code class="docutils literal notranslate">
             <span class="pre">
              ccol_indices
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              row_indices
             </span>
            </code>
            for CSC and BSC layouts, respectively,
are always checked for equality whereas the values are checked for closeness according to the definition above.
           </p>
           <p>
            If
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            are quantized, they are considered close if they have the same
            <a class="reference internal" href="generated/torch.Tensor.qscheme.html#torch.Tensor.qscheme" title="torch.Tensor.qscheme">
             <code class="xref py py-meth docutils literal notranslate">
              <span class="pre">
               qscheme()
              </span>
             </code>
            </a>
            and the result of
            <a class="reference internal" href="generated/torch.Tensor.dequantize.html#torch.Tensor.dequantize" title="torch.Tensor.dequantize">
             <code class="xref py py-meth docutils literal notranslate">
              <span class="pre">
               dequantize()
              </span>
             </code>
            </a>
            is close according to the
definition above.
           </p>
           <p>
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            can be
            <a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Tensor
              </span>
             </code>
            </a>
            ’s or any tensor-or-scalar-likes from which
            <a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               torch.Tensor
              </span>
             </code>
            </a>
            ’s can be constructed with
            <a class="reference internal" href="generated/torch.as_tensor.html#torch.as_tensor" title="torch.as_tensor">
             <code class="xref py py-func docutils literal notranslate">
              <span class="pre">
               torch.as_tensor()
              </span>
             </code>
            </a>
            . Except for Python scalars the input types
have to be directly related. In addition,
            <code class="docutils literal notranslate">
             <span class="pre">
              actual
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              expected
             </span>
            </code>
            can be
            <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Sequence
              </span>
             </code>
            </a>
            ’s
or
            <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.10)">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Mapping
              </span>
             </code>
            </a>
            ’s in which case they are considered close if their structure matches and all
their elements are considered close according to the above definition.
           </p>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             Python scalars are an exception to the type relation requirement, because their
             <code class="xref py py-func docutils literal notranslate">
              <span class="pre">
               type()
              </span>
             </code>
             , i.e.
             <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                int
               </span>
              </code>
             </a>
             ,
             <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                float
               </span>
              </code>
             </a>
             , and
             <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                complex
               </span>
              </code>
             </a>
             , is equivalent to the
             <code class="docutils literal notranslate">
              <span class="pre">
               dtype
              </span>
             </code>
             of a tensor-like. Thus,
Python scalars of different types can be checked, but require
             <code class="docutils literal notranslate">
              <span class="pre">
               check_dtype=False
              </span>
             </code>
             .
            </p>
           </div>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 actual
                </strong>
                (
                <em>
                 Any
                </em>
                ) – Actual input.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 expected
                </strong>
                (
                <em>
                 Any
                </em>
                ) – Expected input.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 allow_subclasses
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                (default) and except for Python scalars, inputs of directly related types
are allowed. Otherwise type equality is required.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 rtol
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – Relative tolerance. If specified
                <code class="docutils literal notranslate">
                 <span class="pre">
                  atol
                 </span>
                </code>
                must also be specified. If omitted, default
values based on the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                are selected with the below table.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 atol
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – Absolute tolerance. If specified
                <code class="docutils literal notranslate">
                 <span class="pre">
                  rtol
                 </span>
                </code>
                must also be specified. If omitted, default
values based on the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                are selected with the below table.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 equal_nan
                </strong>
                (
                <em>
                 Union
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ,
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , two
                <code class="docutils literal notranslate">
                 <span class="pre">
                  NaN
                 </span>
                </code>
                values will be considered equal.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 check_device
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                (default), asserts that corresponding tensors are on the same
                <a class="reference internal" href="generated/torch.Tensor.device.html#torch.Tensor.device" title="torch.Tensor.device">
                 <code class="xref py py-attr docutils literal notranslate">
                  <span class="pre">
                   device
                  </span>
                 </code>
                </a>
                . If this check is disabled, tensors on different
                <a class="reference internal" href="generated/torch.Tensor.device.html#torch.Tensor.device" title="torch.Tensor.device">
                 <code class="xref py py-attr docutils literal notranslate">
                  <span class="pre">
                   device
                  </span>
                 </code>
                </a>
                ’s are moved to the CPU before being compared.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 check_dtype
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                (default), asserts that corresponding tensors have the same
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                . If this
check is disabled, tensors with different
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                ’s are promoted  to a common
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                (according to
                <a class="reference internal" href="generated/torch.promote_types.html#torch.promote_types" title="torch.promote_types">
                 <code class="xref py py-func docutils literal notranslate">
                  <span class="pre">
                   torch.promote_types()
                  </span>
                 </code>
                </a>
                ) before being compared.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 check_layout
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                (default), asserts that corresponding tensors have the same
                <code class="docutils literal notranslate">
                 <span class="pre">
                  layout
                 </span>
                </code>
                . If this
check is disabled, tensors with different
                <code class="docutils literal notranslate">
                 <span class="pre">
                  layout
                 </span>
                </code>
                ’s are converted to strided tensors before being
compared.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 check_stride
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                and corresponding tensors are strided, asserts that they have the same stride.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 msg
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <em>
                 Union
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 Callable
                </em>
                <em>
                 [
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ]
                </em>
                <em>
                 ,
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ]
                </em>
                <em>
                 ]
                </em>
                <em>
                 ]
                </em>
                ) – Optional error message to use in case a failure occurs during
the comparison. Can also passed as callable in which case it will be called with the generated message and
should return the new message.
               </p>
              </li>
             </ul>
            </dd>
            <dt class="field-even">
             Raises
            </dt>
            <dd class="field-even">
             <ul class="simple">
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)">
                 <strong>
                  ValueError
                 </strong>
                </a>
                – If no
                <a class="reference internal" href="tensors.html#torch.Tensor" title="torch.Tensor">
                 <code class="xref py py-class docutils literal notranslate">
                  <span class="pre">
                   torch.Tensor
                  </span>
                 </code>
                </a>
                can be constructed from an input.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)">
                 <strong>
                  ValueError
                 </strong>
                </a>
                – If only
                <code class="docutils literal notranslate">
                 <span class="pre">
                  rtol
                 </span>
                </code>
                or
                <code class="docutils literal notranslate">
                 <span class="pre">
                  atol
                 </span>
                </code>
                is specified.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.10)">
                 <strong>
                  NotImplementedError
                 </strong>
                </a>
                – If a tensor is a meta tensor. This is a temporary restriction and will be relaxed in the
    future.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If corresponding inputs are not Python scalars and are not directly related.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  allow_subclasses
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  False
                 </span>
                </code>
                , but corresponding inputs are not Python scalars and have
    different types.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If the inputs are
                <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)">
                 <code class="xref py py-class docutils literal notranslate">
                  <span class="pre">
                   Sequence
                  </span>
                 </code>
                </a>
                ’s, but their length does not match.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If the inputs are
                <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.10)">
                 <code class="xref py py-class docutils literal notranslate">
                  <span class="pre">
                   Mapping
                  </span>
                 </code>
                </a>
                ’s, but their set of keys do not match.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If corresponding tensors do not have the same
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  shape
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  check_layout
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , but corresponding tensors do not have the same
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  layout
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If only one of corresponding tensors is quantized.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If corresponding tensors are quantized, but have different
                <a class="reference internal" href="generated/torch.Tensor.qscheme.html#torch.Tensor.qscheme" title="torch.Tensor.qscheme">
                 <code class="xref py py-meth docutils literal notranslate">
                  <span class="pre">
                   qscheme()
                  </span>
                 </code>
                </a>
                ’s.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  check_device
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , but corresponding tensors are not on the same
                <a class="reference internal" href="generated/torch.Tensor.device.html#torch.Tensor.device" title="torch.Tensor.device">
                 <code class="xref py py-attr docutils literal notranslate">
                  <span class="pre">
                   device
                  </span>
                 </code>
                </a>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  check_dtype
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , but corresponding tensors do not have the same
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  check_stride
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , but corresponding strided tensors do not have the same stride.
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)">
                 <strong>
                  AssertionError
                 </strong>
                </a>
                – If the values of corresponding tensors are not close according to the definition above.
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <p>
            The following table displays the default
            <code class="docutils literal notranslate">
             <span class="pre">
              rtol
             </span>
            </code>
            and
            <code class="docutils literal notranslate">
             <span class="pre">
              atol
             </span>
            </code>
            for different
            <code class="docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            ’s. In case of mismatching
            <code class="docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            ’s, the maximum of both tolerances is used.
           </p>
           <table class="docutils colwidths-auto align-default">
            <thead>
             <tr class="row-odd">
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
               </p>
              </th>
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  rtol
                 </span>
                </code>
               </p>
              </th>
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  atol
                 </span>
                </code>
               </p>
              </th>
             </tr>
            </thead>
            <tbody>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  float16
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-3
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  bfloat16
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.6e-2
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  float32
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  float64
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-7
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-7
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  complex32
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-3
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  complex64
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  complex128
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-7
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-7
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  quint8
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  quint2x4
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  quint4x2
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  qint8
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  qint32
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1.3e-6
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  1e-5
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                other
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  0.0
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  0.0
                 </span>
                </code>
               </p>
              </td>
             </tr>
            </tbody>
           </table>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <a class="reference internal" href="#torch.testing.assert_close" title="torch.testing.assert_close">
              <code class="xref py py-func docutils literal notranslate">
               <span class="pre">
                assert_close()
               </span>
              </code>
             </a>
             is highly configurable with strict default settings. Users are encouraged
to
             <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partial" title="(in Python v3.10)">
              <code class="xref py py-func docutils literal notranslate">
               <span class="pre">
                partial()
               </span>
              </code>
             </a>
             it to fit their use case. For example, if an equality check is needed, one might
define an
             <code class="docutils literal notranslate">
              <span class="pre">
               assert_equal
              </span>
             </code>
             that uses zero tolrances for every
             <code class="docutils literal notranslate">
              <span class="pre">
               dtype
              </span>
             </code>
             by default:
            </p>
            <div class="doctest highlight-default notranslate">
             <div class="highlight">
              <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">functools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assert_equal</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">assert_equal</span><span class="p">(</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">Scalars are not equal!</span>

<span class="go">Absolute difference: 9.000000000000001e-10</span>
<span class="go">Relative difference: 9.0</span>
</pre>
             </div>
            </div>
           </div>
           <p class="rubric">
            Examples
           </p>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># tensor to tensor comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1e0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># scalar to scalar comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># numpy array to numpy array comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># sequence to sequence comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The types of the sequences do not have to match. They only have to have the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># length and their elements have to match.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]),</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># mapping to mapping comparison</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bar</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The types and a possible ordering of mappings do not have to match. They only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># have to have the same set of keys and their elements have to match.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">"foo"</span><span class="p">,</span> <span class="n">foo</span><span class="p">),</span> <span class="p">(</span><span class="s2">"bar"</span><span class="p">,</span> <span class="n">bar</span><span class="p">),</span> <span class="p">(</span><span class="s2">"baz"</span><span class="p">,</span> <span class="n">baz</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"baz"</span><span class="p">:</span> <span class="n">baz</span><span class="p">,</span> <span class="s2">"bar"</span><span class="p">:</span> <span class="n">bar</span><span class="p">,</span> <span class="s2">"foo"</span><span class="p">:</span> <span class="n">foo</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="n">expected</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># By default, directly related instances can be compared</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">actual</span><span class="p">),</span> <span class="n">expected</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This check can be made more strict with allow_subclasses=False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">actual</span><span class="p">),</span> <span class="n">expected</span><span class="p">,</span> <span class="n">allow_subclasses</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">No comparison pair was able to handle inputs of type</span>
<span class="go">&lt;class 'torch.nn.parameter.Parameter'&gt; and &lt;class 'torch.Tensor'&gt;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If the inputs are not directly related, they are never considered close</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">No comparison pair was able to handle inputs of type &lt;class 'numpy.ndarray'&gt;</span>
<span class="go">and &lt;class 'torch.Tensor'&gt;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exceptions to these rules are Python scalars. They can be checked regardless of</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># their type if check_dtype=False.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">check_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># NaN != NaN by default.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">"Nan"</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="n">expected</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">Scalars are not close!</span>

<span class="go">Absolute difference: nan (up to 1e-05 allowed)</span>
<span class="go">Relative difference: nan (up to 1.3e-06 allowed)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
            </div>
           </div>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expected</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actual</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The default error message can be overwritten.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">"Argh, the tensors are not close!"</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">Argh, the tensors are not close!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If msg is a callable, it can be used to augment the generated message with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># extra information</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">actual</span><span class="p">,</span> <span class="n">expected</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="k">lambda</span> <span class="n">msg</span><span class="p">:</span> <span class="sa">f</span><span class="s2">"Header</span><span class="se">\n\n</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Footer"</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">Header</span>

<span class="go">Tensor-likes are not close!</span>

<span class="go">Mismatched elements: 2 / 3 (66.7%)</span>
<span class="go">Greatest absolute difference: 2.0 at index (1,) (up to 1e-05 allowed)</span>
<span class="go">Greatest relative difference: 1.0 at index (1,) (up to 1.3e-06 allowed)</span>

<span class="go">Footer</span>
</pre>
            </div>
           </div>
          </dd>
         </dl>
         <dl class="py function">
          <dt id="torch.testing.make_tensor">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.testing.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             make_tensor
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="o">
             <span class="pre">
              *
             </span>
            </span>
            <span class="n">
             <span class="pre">
              shape
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              dtype
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              device
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              low
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              high
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              requires_grad
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              noncontiguous
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              exclude_zero
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="_modules/torch/testing/_creation.html#make_tensor">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.testing.make_tensor" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Creates a tensor with the given
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              shape
             </span>
            </code>
            ,
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              device
             </span>
            </code>
            , and
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            , and filled with
values uniformly drawn from
            <code class="docutils literal notranslate">
             <span class="pre">
              [low,
             </span>
             <span class="pre">
              high)
             </span>
            </code>
            .
           </p>
           <p>
            If
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              low
             </span>
            </code>
            or
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              high
             </span>
            </code>
            are specified and are outside the range of the
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            ’s representable
finite values then they are clamped to the lowest or highest representable finite value, respectively.
If
            <code class="docutils literal notranslate">
             <span class="pre">
              None
             </span>
            </code>
            , then the following table describes the default values for
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              low
             </span>
            </code>
            and
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              high
             </span>
            </code>
            ,
which depend on
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              dtype
             </span>
            </code>
            .
           </p>
           <table class="docutils colwidths-auto align-default">
            <thead>
             <tr class="row-odd">
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
               </p>
              </th>
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  low
                 </span>
                </code>
               </p>
              </th>
              <th class="head">
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  high
                 </span>
                </code>
               </p>
              </th>
             </tr>
            </thead>
            <tbody>
             <tr class="row-even">
              <td>
               <p>
                boolean type
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  0
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  2
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                unsigned integral type
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  0
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  10
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                signed integral types
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  -9
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  10
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-odd">
              <td>
               <p>
                floating types
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  -9
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  9
                 </span>
                </code>
               </p>
              </td>
             </tr>
             <tr class="row-even">
              <td>
               <p>
                complex types
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  -9
                 </span>
                </code>
               </p>
              </td>
              <td>
               <p>
                <code class="docutils literal notranslate">
                 <span class="pre">
                  9
                 </span>
                </code>
               </p>
              </td>
             </tr>
            </tbody>
           </table>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 shape
                </strong>
                (
                <em>
                 Tuple
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 ..
                </em>
                <em>
                 ]
                </em>
                ) – Single integer or a sequence of integers defining the shape of the output tensor.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 dtype
                </strong>
                (
                <a class="reference internal" href="tensor_attributes.html#torch.dtype" title="torch.dtype">
                 <code class="xref py py-class docutils literal notranslate">
                  <span class="pre">
                   torch.dtype
                  </span>
                 </code>
                </a>
                ) – The data type of the returned tensor.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 device
                </strong>
                (
                <em>
                 Union
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ,
                </em>
                <a class="reference internal" href="tensor_attributes.html#torch.device" title="torch.device">
                 <em>
                  torch.device
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – The device of the returned tensor.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 low
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <em>
                 Number
                </em>
                <em>
                 ]
                </em>
                ) – Sets the lower limit (inclusive) of the given range. If a number is provided it is
clamped to the least representable finite value of the given dtype. When
                <code class="docutils literal notranslate">
                 <span class="pre">
                  None
                 </span>
                </code>
                (default),
this value is determined based on the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                (see the table above). Default:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  None
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <strong>
                 high
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <em>
                 Number
                </em>
                <em>
                 ]
                </em>
                ) – Sets the upper limit (exclusive) of the given range. If a number is provided it is
clamped to the greatest representable finite value of the given dtype. When
                <code class="docutils literal notranslate">
                 <span class="pre">
                  None
                 </span>
                </code>
                (default) this value
is determined based on the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                (see the table above). Default:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  None
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <strong>
                 requires_grad
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – If autograd should record operations on the returned tensor. Default:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  False
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <strong>
                 noncontiguous
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – If
                <cite>
                 True
                </cite>
                , the returned tensor will be noncontiguous. This argument is
ignored if the constructed tensor has fewer than two elements.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 exclude_zero
                </strong>
                (
                <em>
                 Optional
                </em>
                <em>
                 [
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ]
                </em>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                then zeros are replaced with the dtype’s small positive value
depending on the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                . For bool and integer types zero is replaced with one. For floating
point types it is replaced with the dtype’s smallest positive normal number (the “tiny” value of the
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                ’s
                <code class="xref py py-func docutils literal notranslate">
                 <span class="pre">
                  finfo()
                 </span>
                </code>
                object), and for complex types it is replaced with a complex number
whose real and imaginary parts are both the smallest positive normal number representable by the complex
type. Default
                <code class="docutils literal notranslate">
                 <span class="pre">
                  False
                 </span>
                </code>
                .
               </p>
              </li>
             </ul>
            </dd>
            <dt class="field-even">
             Raises
            </dt>
            <dd class="field-even">
             <ul class="simple">
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)">
                 <strong>
                  ValueError
                 </strong>
                </a>
                – if
                <code class="docutils literal notranslate">
                 <span class="pre">
                  requires_grad=True
                 </span>
                </code>
                is passed for integral
                <cite>
                 dtype
                </cite>
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)">
                 <strong>
                  ValueError
                 </strong>
                </a>
                – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  low
                 </span>
                 <span class="pre">
                  &gt;
                 </span>
                 <span class="pre">
                  high
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)">
                 <strong>
                  ValueError
                 </strong>
                </a>
                – If either
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  low
                 </span>
                </code>
                or
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  high
                 </span>
                </code>
                is
                <code class="docutils literal notranslate">
                 <span class="pre">
                  nan
                 </span>
                </code>
                .
               </p>
              </li>
              <li>
               <p>
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)">
                 <strong>
                  TypeError
                 </strong>
                </a>
                – If
                <code class="xref py py-attr docutils literal notranslate">
                 <span class="pre">
                  dtype
                 </span>
                </code>
                isn’t supported by this function.
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <p class="rubric">
            Examples
           </p>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">torch.testing</span> <span class="kn">import</span> <span class="n">make_tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creates a float tensor with values in [-1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_tensor</span><span class="p">((</span><span class="mi">3</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="s1">'cpu'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">low</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">tensor([ 0.1205, 0.2282, -0.6380])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creates a bool tensor on CUDA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_tensor</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">'cuda'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="go">tensor([[False, False],</span>
<span class="go">        [False, True]], device='cuda:0')</span>
</pre>
            </div>
           </div>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>