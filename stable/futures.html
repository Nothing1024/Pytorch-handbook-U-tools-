<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   torch.futures — PyTorch 1.11.0 documentation
  </title>
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="torch-futures">
         <span id="futures-docs">
         </span>
         <h1>
          torch.futures
          <a class="headerlink" href="#torch-futures" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <p>
          This package provides a
          <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
           <code class="xref py py-class docutils literal notranslate">
            <span class="pre">
             Future
            </span>
           </code>
          </a>
          type that encapsulates
an asynchronous execution and a set of utility functions to simplify operations
on
          <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
           <code class="xref py py-class docutils literal notranslate">
            <span class="pre">
             Future
            </span>
           </code>
          </a>
          objects. Currently, the
          <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
           <code class="xref py py-class docutils literal notranslate">
            <span class="pre">
             Future
            </span>
           </code>
          </a>
          type is primarily used by the
          <a class="reference internal" href="rpc.html#distributed-rpc-framework">
           <span class="std std-ref">
            Distributed RPC Framework
           </span>
          </a>
          .
         </p>
         <span class="target" id="module-torch.futures">
         </span>
         <dl class="py class">
          <dt id="torch.futures.Future">
           <em class="property">
            <span class="pre">
             class
            </span>
           </em>
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.futures.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             Future
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="o">
             <span class="pre">
              *
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              devices
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="headerlink" href="#torch.futures.Future" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Wrapper around a
            <code class="docutils literal notranslate">
             <span class="pre">
              torch._C.Future
             </span>
            </code>
            which encapsulates an asynchronous
execution of a callable, e.g.
            <a class="reference internal" href="rpc.html#torch.distributed.rpc.rpc_async" title="torch.distributed.rpc.rpc_async">
             <code class="xref py py-meth docutils literal notranslate">
              <span class="pre">
               rpc_async()
              </span>
             </code>
            </a>
            . It
also exposes a set of APIs to add callback functions and set results.
           </p>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             GPU support is a beta feature, subject to changes.
            </p>
           </div>
           <dl class="py method">
            <dt id="torch.futures.Future.add_done_callback">
             <code class="sig-name descname">
              <span class="pre">
               add_done_callback
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                callback
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.add_done_callback">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.add_done_callback" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Append the given callback function to this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , which will be run
when the
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is completed.  Multiple callbacks can be added to
the same
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , but the order in which they will be executed cannot
be guaranteed. The callback must take one argument, which is the
reference to this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              . The callback function can use the
              <a class="reference internal" href="#torch.futures.Future.value" title="torch.futures.Future.value">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 value()
                </span>
               </code>
              </a>
              method to get the value. Note that if this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is
already completed, the given callback will be run inline.
             </p>
             <p>
              We recommend that you use the
              <a class="reference internal" href="#torch.futures.Future.then" title="torch.futures.Future.then">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 then()
                </span>
               </code>
              </a>
              method as it provides a way
to synchronize after your callback has completed.
              <code class="docutils literal notranslate">
               <span class="pre">
                add_done_callback
               </span>
              </code>
              can be cheaper if your callback does not return anything. But both
              <a class="reference internal" href="#torch.futures.Future.then" title="torch.futures.Future.then">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 then()
                </span>
               </code>
              </a>
              and
              <code class="docutils literal notranslate">
               <span class="pre">
                add_done_callback
               </span>
              </code>
              use the same callback
registration API under the hood.
             </p>
             <p>
              With respect to GPU tensors, this method behaves in the same way as
              <a class="reference internal" href="#torch.futures.Future.then" title="torch.futures.Future.then">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 then()
                </span>
               </code>
              </a>
              .
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 callback
                </strong>
                (
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                ) – a
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Callable
                 </span>
                </code>
                that takes in one argument,
which is the reference to this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                .
               </p>
              </dd>
             </dl>
             <div class="admonition note">
              <p class="admonition-title">
               Note
              </p>
              <p>
               Note that if the callback function throws, either
through the original future being completed with an exception and
calling
               <code class="docutils literal notranslate">
                <span class="pre">
                 fut.wait()
                </span>
               </code>
               , or through other code in the callback,
error handling must be carefully taken care of. For example, if
this callback later completes additional futures, those futures are
not marked as completed with an error and the user is responsible
for handling completion/waiting on those futures independently.
              </p>
             </div>
             <dl>
              <dt>
               Example::
              </dt>
              <dd>
               <div class="doctest highlight-default notranslate">
                <div class="highlight">
                 <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">fut</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"This will run after the future has finished."</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">fut</span><span class="o">.</span><span class="n">wait</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">This will run after the future has finished.</span>
<span class="go">5</span>
</pre>
                </div>
               </div>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.done">
             <code class="sig-name descname">
              <span class="pre">
               done
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.done">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.done" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Return
              <code class="docutils literal notranslate">
               <span class="pre">
                True
               </span>
              </code>
              if this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is done. A
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is done if it
has a result or an exception.
             </p>
             <p>
              If the value contains tensors that reside on GPUs,
              <code class="docutils literal notranslate">
               <span class="pre">
                Future.done()
               </span>
              </code>
              will return
              <code class="docutils literal notranslate">
               <span class="pre">
                True
               </span>
              </code>
              even if the asynchronous kernels that are
populating those tensors haven’t yet completed running on the device,
because at such stage the result is already usable, provided one
performs the appropriate synchronizations (see
              <a class="reference internal" href="#torch.futures.Future.wait" title="torch.futures.Future.wait">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 wait()
                </span>
               </code>
              </a>
              ).
             </p>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.set_exception">
             <code class="sig-name descname">
              <span class="pre">
               set_exception
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                result
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.set_exception">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.set_exception" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Set an exception for this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , which will mark this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              as
completed with an error and trigger all attached callbacks. Note that
when calling wait()/value() on this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , the exception set here
will be raised inline.
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 result
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#BaseException" title="(in Python v3.10)">
                 <em>
                  BaseException
                 </em>
                </a>
                ) – the exception for this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                .
               </p>
              </dd>
             </dl>
             <dl>
              <dt>
               Example::
              </dt>
              <dd>
               <div class="doctest highlight-default notranslate">
                <div class="highlight">
                 <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span><span class="o">.</span><span class="n">set_exception</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">"foo"</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">foo</span>
</pre>
                </div>
               </div>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.set_result">
             <code class="sig-name descname">
              <span class="pre">
               set_result
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                result
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.set_result">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.set_result" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Set the result for this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , which will mark this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              as
completed and trigger all attached callbacks. Note that a
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              cannot be marked completed twice.
             </p>
             <p>
              If the result contains tensors that reside on GPUs, this method can be
called even if the asynchronous kernels that are populating those
tensors haven’t yet completed running on the device, provided that the
streams on which those kernels were enqueued are set as the current ones
when this method is called. Put simply, it’s safe to call this method
immediately after launching those kernels, without any additional
synchronization, as long as one doesn’t change streams in between. This
method will record events on all the relevant current streams and will
use them to ensure proper scheduling for all the consumers of this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              .
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 result
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)">
                 <em>
                  object
                 </em>
                </a>
                ) – the result object of this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                .
               </p>
              </dd>
             </dl>
             <dl>
              <dt>
               Example::
              </dt>
              <dd>
               <div class="doctest highlight-default notranslate">
                <div class="highlight">
                 <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">threading</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slow_set_future</span><span class="p">(</span><span class="n">fut</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fut</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">target</span><span class="o">=</span><span class="n">slow_set_future</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">fut</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fut</span><span class="o">.</span><span class="n">wait</span><span class="p">())</span>
<span class="go">tensor([3., 3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre>
                </div>
               </div>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.then">
             <code class="sig-name descname">
              <span class="pre">
               then
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                callback
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.then">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.then" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Append the given callback function to this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , which will be run
when the
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is completed.  Multiple callbacks can be added to
the same
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              , but the order in which they will be executed cannot
be guaranteed (to enforce a certain order consider chaining:
              <code class="docutils literal notranslate">
               <span class="pre">
                fut.then(cb1).then(cb2)
               </span>
              </code>
              ). The callback must take one argument, which
is the reference to this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              . The callback function can use the
              <a class="reference internal" href="#torch.futures.Future.value" title="torch.futures.Future.value">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 value()
                </span>
               </code>
              </a>
              method to get the value. Note that if this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is
already completed, the given callback will be run immediately inline.
             </p>
             <p>
              If the
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              ’s value contains tensors that reside on GPUs, the
callback might be invoked while the async kernels that are populating
those tensors haven’t yet finished executing on the device. However, the
callback will be invoked with some dedicated streams set as current
(fetched from a global pool) which will be synchronized with those
kernels. Hence any operation performed by the callback on these tensors
will be scheduled on the device after the kernels complete. In other
words, as long as the callback doesn’t switch streams, it can safely
manipulate the result without any additional synchronization. This is
similar to the non-blocking behavior of
              <a class="reference internal" href="#torch.futures.Future.wait" title="torch.futures.Future.wait">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 wait()
                </span>
               </code>
              </a>
              .
             </p>
             <p>
              Similarly, if the callback returns a value that contains tensors that
reside on a GPU, it can do so even if the kernels that are producing
these tensors are still running on the device, as long as the callback
didn’t change streams during its execution. If one wants to change
streams, one must be careful to re-synchronize them with the original
streams, that is, those that were current when the callback was invoked.
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 callback
                </strong>
                (
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Callable
                 </span>
                </code>
                ) – a
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Callable
                 </span>
                </code>
                that takes this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                as
the only argument.
               </p>
              </dd>
              <dt class="field-even">
               Returns
              </dt>
              <dd class="field-even">
               <p>
                A new
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                object that holds the return value of the
                <code class="docutils literal notranslate">
                 <span class="pre">
                  callback
                 </span>
                </code>
                and will be marked as completed when the given
                <code class="docutils literal notranslate">
                 <span class="pre">
                  callback
                 </span>
                </code>
                finishes.
               </p>
              </dd>
             </dl>
             <div class="admonition note">
              <p class="admonition-title">
               Note
              </p>
              <p>
               Note that if the callback function throws, either
through the original future being completed with an exception and
calling
               <code class="docutils literal notranslate">
                <span class="pre">
                 fut.wait()
                </span>
               </code>
               , or through other code in the callback, the
future returned by
               <code class="docutils literal notranslate">
                <span class="pre">
                 then
                </span>
               </code>
               will be marked appropriately with the
encountered error. However, if this callback later completes
additional futures, those futures are not marked as completed with
an error and the user is responsible for handling completion/waiting
on those futures independently.
              </p>
             </div>
             <dl>
              <dt>
               Example::
              </dt>
              <dd>
               <div class="doctest highlight-default notranslate">
                <div class="highlight">
                 <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">fut</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"RPC return value is </span><span class="si">{</span><span class="n">fut</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The inserted callback will print the return value when</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># receiving the response from "worker1"</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb_fut</span> <span class="o">=</span> <span class="n">fut</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain_cb_fut</span> <span class="o">=</span> <span class="n">cb_fut</span><span class="o">.</span><span class="n">then</span><span class="p">(</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Chained cb done. </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">RPC return value is 5.</span>
<span class="go">Chained cb done. None</span>
</pre>
                </div>
               </div>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.value">
             <code class="sig-name descname">
              <span class="pre">
               value
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.value">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.value" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Obtain the value of an already-completed future.
             </p>
             <p>
              This method should only be called after a call to
              <a class="reference internal" href="#torch.futures.Future.wait" title="torch.futures.Future.wait">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 wait()
                </span>
               </code>
              </a>
              has
completed, or inside a callback function passed to
              <a class="reference internal" href="#torch.futures.Future.then" title="torch.futures.Future.then">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 then()
                </span>
               </code>
              </a>
              . In
other cases this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              may not yet hold a value and calling
              <code class="docutils literal notranslate">
               <span class="pre">
                value()
               </span>
              </code>
              could fail.
             </p>
             <p>
              If the value contains tensors that reside on GPUs, then this method will
              <em>
               not
              </em>
              perform any additional synchronization. This should be done
beforehand, separately, through a call to
              <a class="reference internal" href="#torch.futures.Future.wait" title="torch.futures.Future.wait">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 wait()
                </span>
               </code>
              </a>
              (except within
callbacks, for which it’s already being taken care of by
              <a class="reference internal" href="#torch.futures.Future.then" title="torch.futures.Future.then">
               <code class="xref py py-meth docutils literal notranslate">
                <span class="pre">
                 then()
                </span>
               </code>
              </a>
              ).
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Returns
              </dt>
              <dd class="field-odd">
               <p>
                The value held by this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                . If the function (callback or RPC)
creating the value has thrown an error, this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  value()
                 </span>
                </code>
                method will
also throw an error.
               </p>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.futures.Future.wait">
             <code class="sig-name descname">
              <span class="pre">
               wait
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="_modules/torch/futures.html#Future.wait">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.futures.Future.wait" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Block until the value of this
              <code class="docutils literal notranslate">
               <span class="pre">
                Future
               </span>
              </code>
              is ready.
             </p>
             <p>
              If the value contains tensors that reside on GPUs, then an additional
synchronization is performed with the kernels (executing on the device)
which may be asynchronously populating those tensors. Such sync is
non-blocking, which means that
              <code class="docutils literal notranslate">
               <span class="pre">
                wait()
               </span>
              </code>
              will insert the necessary
instructions in the current streams to ensure that further operations
enqueued on those streams will be properly scheduled after the async
kernels but, once that is done,
              <code class="docutils literal notranslate">
               <span class="pre">
                wait()
               </span>
              </code>
              will return, even if those
kernels are still running. No further synchronization is required when
accessing and using the values, as long as one doesn’t change streams.
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Returns
              </dt>
              <dd class="field-odd">
               <p>
                The value held by this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Future
                 </span>
                </code>
                . If the function (callback or RPC)
creating the value has thrown an error, this
                <code class="docutils literal notranslate">
                 <span class="pre">
                  wait
                 </span>
                </code>
                method will
also throw an error.
               </p>
              </dd>
             </dl>
            </dd>
           </dl>
          </dd>
         </dl>
         <dl class="py function">
          <dt id="torch.futures.collect_all">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.futures.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             collect_all
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              futures
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="_modules/torch/futures.html#collect_all">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.futures.collect_all" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Collects the provided
            <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Future
              </span>
             </code>
            </a>
            objects into a single
combined
            <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Future
              </span>
             </code>
            </a>
            that is completed when all of the
sub-futures are completed.
           </p>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <p>
              <strong>
               futures
              </strong>
              (
              <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">
               <em>
                list
               </em>
              </a>
              ) – a list of
              <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 Future
                </span>
               </code>
              </a>
              objects.
             </p>
            </dd>
            <dt class="field-even">
             Returns
            </dt>
            <dd class="field-even">
             <p>
              Returns a
              <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 Future
                </span>
               </code>
              </a>
              object to a list of the passed
in Futures.
             </p>
            </dd>
           </dl>
           <dl>
            <dt>
             Example::
            </dt>
            <dd>
             <div class="doctest highlight-default notranslate">
              <div class="highlight">
               <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fut0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">collect_all</span><span class="p">([</span><span class="n">fut0</span><span class="p">,</span> <span class="n">fut1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut0</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut1</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fut_list</span> <span class="o">=</span> <span class="n">fut</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"fut0 result = </span><span class="si">{</span><span class="n">fut_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="go">fut0 result = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"fut1 result = </span><span class="si">{</span><span class="n">fut_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="go">fut1 result = 1</span>
</pre>
              </div>
             </div>
            </dd>
           </dl>
          </dd>
         </dl>
         <dl class="py function">
          <dt id="torch.futures.wait_all">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.futures.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             wait_all
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              futures
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="_modules/torch/futures.html#wait_all">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.futures.wait_all" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Waits for all provided futures to be complete, and returns
the list of completed values. If any of the futures encounters an error,
the method will exit early and report the error not waiting for other
futures to complete.
           </p>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <p>
              <strong>
               futures
              </strong>
              (
              <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">
               <em>
                list
               </em>
              </a>
              ) – a list of
              <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 Future
                </span>
               </code>
              </a>
              object.
             </p>
            </dd>
            <dt class="field-even">
             Returns
            </dt>
            <dd class="field-even">
             <p>
              A list of the completed
              <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 Future
                </span>
               </code>
              </a>
              results. This
method will throw an error if
              <code class="docutils literal notranslate">
               <span class="pre">
                wait
               </span>
              </code>
              on any
              <a class="reference internal" href="#torch.futures.Future" title="torch.futures.Future">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 Future
                </span>
               </code>
              </a>
              throws.
             </p>
            </dd>
           </dl>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>