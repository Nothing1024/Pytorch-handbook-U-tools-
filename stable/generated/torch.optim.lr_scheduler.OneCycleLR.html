<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   OneCycleLR — PyTorch 1.11.0 documentation
  </title>
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="onecyclelr">
         <h1>
          OneCycleLR
          <a class="headerlink" href="#onecyclelr" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py class">
          <dt id="torch.optim.lr_scheduler.OneCycleLR">
           <em class="property">
            <span class="pre">
             class
            </span>
           </em>
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.optim.lr_scheduler.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             OneCycleLR
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              optimizer
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              max_lr
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              total_steps
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              epochs
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              steps_per_epoch
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              pct_start
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              0.3
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              anneal_strategy
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              'cos'
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              cycle_momentum
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              base_momentum
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              0.85
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              max_momentum
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              0.95
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              div_factor
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              25.0
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              final_div_factor
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              10000.0
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              three_phase
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              last_epoch
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              -
             </span>
             <span class="pre">
              1
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              verbose
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="../_modules/torch/optim/lr_scheduler.html#OneCycleLR">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.optim.lr_scheduler.OneCycleLR" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Sets the learning rate of each parameter group according to the
1cycle learning rate policy. The 1cycle policy anneals the learning
rate from an initial learning rate to some maximum learning rate and then
from that maximum learning rate to some minimum learning rate much lower
than the initial learning rate.
This policy was initially described in the paper
            <a class="reference external" href="https://arxiv.org/abs/1708.07120">
             Super-Convergence:
Very Fast Training of Neural Networks Using Large Learning Rates
            </a>
            .
           </p>
           <p>
            The 1cycle learning rate policy changes the learning rate after every batch.
            <cite>
             step
            </cite>
            should be called after a batch has been used for training.
           </p>
           <p>
            This scheduler is not chainable.
           </p>
           <p>
            Note also that the total number of steps in the cycle can be determined in one
of two ways (listed in order of precedence):
           </p>
           <ol class="arabic simple">
            <li>
             <p>
              A value for total_steps is explicitly provided.
             </p>
            </li>
            <li>
             <p>
              A number of epochs (epochs) and a number of steps per epoch
(steps_per_epoch) are provided.
In this case, the number of total steps is inferred by
total_steps = epochs * steps_per_epoch
             </p>
            </li>
           </ol>
           <p>
            You must either provide a value for total_steps or provide a value for both
epochs and steps_per_epoch.
           </p>
           <p>
            The default behaviour of this scheduler follows the fastai implementation of 1cycle, which
claims that “unpublished work has shown even better results by using only two phases”. To
mimic the behaviour of the original paper instead, set
            <code class="docutils literal notranslate">
             <span class="pre">
              three_phase=True
             </span>
            </code>
            .
           </p>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 optimizer
                </strong>
                (
                <a class="reference internal" href="../optim.html#torch.optim.Optimizer" title="torch.optim.Optimizer">
                 <em>
                  Optimizer
                 </em>
                </a>
                ) – Wrapped optimizer.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 max_lr
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">
                 <em>
                  list
                 </em>
                </a>
                ) – Upper learning rate boundaries in the cycle
for each parameter group.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 total_steps
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – The total number of steps in the cycle. Note that
if a value is not provided here, then it must be inferred by providing
a value for epochs and steps_per_epoch.
Default: None
               </p>
              </li>
              <li>
               <p>
                <strong>
                 epochs
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – The number of epochs to train for. This is used along
with steps_per_epoch in order to infer the total number of steps in the cycle
if a value for total_steps is not provided.
Default: None
               </p>
              </li>
              <li>
               <p>
                <strong>
                 steps_per_epoch
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – The number of steps per epoch to train for. This is
used along with epochs in order to infer the total number of steps in the
cycle if a value for total_steps is not provided.
Default: None
               </p>
              </li>
              <li>
               <p>
                <strong>
                 pct_start
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                ) – The percentage of the cycle (in number of steps) spent
increasing the learning rate.
Default: 0.3
               </p>
              </li>
              <li>
               <p>
                <strong>
                 anneal_strategy
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                ) – {‘cos’, ‘linear’}
Specifies the annealing strategy: “cos” for cosine annealing, “linear” for
linear annealing.
Default: ‘cos’
               </p>
              </li>
              <li>
               <p>
                <strong>
                 cycle_momentum
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , momentum is cycled inversely
to learning rate between ‘base_momentum’ and ‘max_momentum’.
Default: True
               </p>
              </li>
              <li>
               <p>
                <strong>
                 base_momentum
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">
                 <em>
                  list
                 </em>
                </a>
                ) – Lower momentum boundaries in the cycle
for each parameter group. Note that momentum is cycled inversely
to learning rate; at the peak of a cycle, momentum is
‘base_momentum’ and learning rate is ‘max_lr’.
Default: 0.85
               </p>
              </li>
              <li>
               <p>
                <strong>
                 max_momentum
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">
                 <em>
                  list
                 </em>
                </a>
                ) – Upper momentum boundaries in the cycle
for each parameter group. Functionally,
it defines the cycle amplitude (max_momentum - base_momentum).
Note that momentum is cycled inversely
to learning rate; at the start of a cycle, momentum is ‘max_momentum’
and learning rate is ‘base_lr’
Default: 0.95
               </p>
              </li>
              <li>
               <p>
                <strong>
                 div_factor
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                ) – Determines the initial learning rate via
initial_lr = max_lr/div_factor
Default: 25
               </p>
              </li>
              <li>
               <p>
                <strong>
                 final_div_factor
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                ) – Determines the minimum learning rate via
min_lr = initial_lr/final_div_factor
Default: 1e4
               </p>
              </li>
              <li>
               <p>
                <strong>
                 three_phase
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , use a third phase of the schedule to annihilate the
learning rate according to ‘final_div_factor’ instead of modifying the second
phase (the first two phases will be symmetrical about the step indicated by
‘pct_start’).
               </p>
              </li>
              <li>
               <p>
                <strong>
                 last_epoch
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – The index of the last batch. This parameter is used when
resuming a training job. Since
                <cite>
                 step()
                </cite>
                should be invoked after each
batch instead of after each epoch, this number represents the total
number of
                <em>
                 batches
                </em>
                computed, not the total number of epochs computed.
When last_epoch=-1, the schedule is started from the beginning.
Default: -1
               </p>
              </li>
              <li>
               <p>
                <strong>
                 verbose
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , prints a message to stdout for
each update. Default:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  False
                 </span>
                </code>
                .
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <p class="rubric">
            Example
           </p>
           <div class="doctest highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data_loader</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">data_loader</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">train_batch</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre>
            </div>
           </div>
           <dl class="py method">
            <dt id="torch.optim.lr_scheduler.OneCycleLR.get_last_lr">
             <code class="sig-name descname">
              <span class="pre">
               get_last_lr
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <span class="sig-paren">
              )
             </span>
             <a class="headerlink" href="#torch.optim.lr_scheduler.OneCycleLR.get_last_lr" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Return last computed learning rate by current scheduler.
             </p>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.optim.lr_scheduler.OneCycleLR.load_state_dict">
             <code class="sig-name descname">
              <span class="pre">
               load_state_dict
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                state_dict
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="headerlink" href="#torch.optim.lr_scheduler.OneCycleLR.load_state_dict" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Loads the schedulers state.
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 state_dict
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">
                 <em>
                  dict
                 </em>
                </a>
                ) – scheduler state. Should be an object returned
from a call to
                <a class="reference internal" href="#torch.optim.lr_scheduler.OneCycleLR.state_dict" title="torch.optim.lr_scheduler.OneCycleLR.state_dict">
                 <code class="xref py py-meth docutils literal notranslate">
                  <span class="pre">
                   state_dict()
                  </span>
                 </code>
                </a>
                .
               </p>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.optim.lr_scheduler.OneCycleLR.print_lr">
             <code class="sig-name descname">
              <span class="pre">
               print_lr
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                is_verbose
               </span>
              </span>
             </em>
             ,
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                group
               </span>
              </span>
             </em>
             ,
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                lr
               </span>
              </span>
             </em>
             ,
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                epoch
               </span>
              </span>
              <span class="o">
               <span class="pre">
                =
               </span>
              </span>
              <span class="default_value">
               <span class="pre">
                None
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="headerlink" href="#torch.optim.lr_scheduler.OneCycleLR.print_lr" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Display the current learning rate.
             </p>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.optim.lr_scheduler.OneCycleLR.state_dict">
             <code class="sig-name descname">
              <span class="pre">
               state_dict
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <span class="sig-paren">
              )
             </span>
             <a class="headerlink" href="#torch.optim.lr_scheduler.OneCycleLR.state_dict" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Returns the state of the scheduler as a
              <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">
               <code class="xref py py-class docutils literal notranslate">
                <span class="pre">
                 dict
                </span>
               </code>
              </a>
              .
             </p>
             <p>
              It contains an entry for every variable in self.__dict__ which
is not the optimizer.
             </p>
            </dd>
           </dl>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>