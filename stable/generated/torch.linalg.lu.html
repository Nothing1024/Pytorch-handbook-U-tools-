<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   torch.linalg.lu — PyTorch 1.12 documentation
  </title>
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="torch-linalg-lu">
         <h1>
          torch.linalg.lu
          <a class="headerlink" href="#torch-linalg-lu" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py function">
          <dt id="torch.linalg.lu">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.linalg.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             lu
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              A
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="o">
             <span class="pre">
              *
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              pivot
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              True
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              out
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="headerlink" href="#torch.linalg.lu" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Computes the LU decomposition with partial pivoting of a matrix.
           </p>
           <p>
            Letting
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   K
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{K}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6889em;">
                </span>
                <span class="mord mathbb">
                 K
                </span>
               </span>
              </span>
             </span>
            </span>
            be
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   R
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{R}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6889em;">
                </span>
                <span class="mord mathbb">
                 R
                </span>
               </span>
              </span>
             </span>
            </span>
            or
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   C
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{C}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6889em;">
                </span>
                <span class="mord mathbb">
                 C
                </span>
               </span>
              </span>
             </span>
            </span>
            ,
the
            <strong>
             LU decomposition with partial pivoting
            </strong>
            of a matrix
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   ∈
                  </mo>
                  <msup>
                   <mi mathvariant="double-struck">
                    K
                   </mi>
                   <mrow>
                    <mi>
                     m
                    </mi>
                    <mo>
                     ×
                    </mo>
                    <mi>
                     n
                    </mi>
                   </mrow>
                  </msup>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A \in \mathbb{K}^{m \times n}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.7224em;vertical-align:-0.0391em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
                <span class="mrel">
                 ∈
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:0.7713em;">
                </span>
                <span class="mord">
                 <span class="mord mathbb">
                  K
                 </span>
                 <span class="msupsub">
                  <span class="vlist-t">
                   <span class="vlist-r">
                    <span class="vlist" style="height:0.7713em;">
                     <span style="top:-3.063em;margin-right:0.05em;">
                      <span class="pstrut" style="height:2.7em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mtight">
                        <span class="mord mathnormal mtight">
                         m
                        </span>
                        <span class="mbin mtight">
                         ×
                        </span>
                        <span class="mord mathnormal mtight">
                         n
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            if
            <cite>
             k = min(m,n)
            </cite>
            , is defined as
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   =
                  </mo>
                  <mi>
                   P
                  </mi>
                  <mi>
                   L
                  </mi>
                  <mi>
                   U
                  </mi>
                  <mpadded width="0px">
                   <mrow>
                    <mspace width="2em">
                    </mspace>
                    <mi>
                     P
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       m
                      </mi>
                     </mrow>
                    </msup>
                    <mo separator="true">
                     ,
                    </mo>
                    <mi>
                     L
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       k
                      </mi>
                     </mrow>
                    </msup>
                    <mo separator="true">
                     ,
                    </mo>
                    <mi>
                     U
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       k
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       n
                      </mi>
                     </mrow>
                    </msup>
                   </mrow>
                  </mpadded>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A = PLU\mathrlap{\qquad P \in \mathbb{K}^{m \times m}, L \in \mathbb{K}^{m \times k}, U \in \mathbb{K}^{k \times n}}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
                <span class="mrel">
                 =
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.0935em;vertical-align:-0.1944em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.13889em;">
                 P
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 LU
                </span>
                <span class="mord vbox">
                 <span class="thinbox">
                  <span class="rlap">
                   <span class="strut" style="height:1.0935em;vertical-align:-0.1944em;">
                   </span>
                   <span class="inner">
                    <span class="mord">
                     <span class="mspace" style="margin-right:2em;">
                     </span>
                     <span class="mord mathnormal" style="margin-right:0.13889em;">
                      P
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.8213em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mpunct">
                      ,
                     </span>
                     <span class="mspace" style="margin-right:0.1667em;">
                     </span>
                     <span class="mord mathnormal">
                      L
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.8991em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight" style="margin-right:0.03148em;">
                              k
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mpunct">
                      ,
                     </span>
                     <span class="mspace" style="margin-right:0.1667em;">
                     </span>
                     <span class="mord mathnormal" style="margin-right:0.10903em;">
                      U
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.8991em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight" style="margin-right:0.03148em;">
                              k
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="fix">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            where
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   P
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  P
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.13889em;">
                 P
                </span>
               </span>
              </span>
             </span>
            </span>
            is a
            <a class="reference external" href="https://en.wikipedia.org/wiki/Permutation_matrix">
             permutation matrix
            </a>
            ,
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   L
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  L
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal">
                 L
                </span>
               </span>
              </span>
             </span>
            </span>
            is lower triangular with ones on the diagonal
and
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   U
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  U
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 U
                </span>
               </span>
              </span>
             </span>
            </span>
            is upper triangular.
           </p>
           <p>
            If
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              pivot
             </span>
            </code>
            <cite>
             = False
            </cite>
            and
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              A
             </span>
            </code>
            is on GPU, then the
            <strong>
             LU decomposition without pivoting
            </strong>
            is computed
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   =
                  </mo>
                  <mi>
                   L
                  </mi>
                  <mi>
                   U
                  </mi>
                  <mpadded width="0px">
                   <mrow>
                    <mspace width="2em">
                    </mspace>
                    <mi>
                     L
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       k
                      </mi>
                     </mrow>
                    </msup>
                    <mo separator="true">
                     ,
                    </mo>
                    <mi>
                     U
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       k
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       n
                      </mi>
                     </mrow>
                    </msup>
                   </mrow>
                  </mpadded>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A = LU\mathrlap{\qquad L \in \mathbb{K}^{m \times k}, U \in \mathbb{K}^{k \times n}}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
                <span class="mrel">
                 =
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.0935em;vertical-align:-0.1944em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 LU
                </span>
                <span class="mord vbox">
                 <span class="thinbox">
                  <span class="rlap">
                   <span class="strut" style="height:1.0935em;vertical-align:-0.1944em;">
                   </span>
                   <span class="inner">
                    <span class="mord">
                     <span class="mspace" style="margin-right:2em;">
                     </span>
                     <span class="mord mathnormal">
                      L
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.8991em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight" style="margin-right:0.03148em;">
                              k
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mpunct">
                      ,
                     </span>
                     <span class="mspace" style="margin-right:0.1667em;">
                     </span>
                     <span class="mord mathnormal" style="margin-right:0.10903em;">
                      U
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.8991em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight" style="margin-right:0.03148em;">
                              k
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="fix">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            When
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              pivot
             </span>
            </code>
            <cite>
             = False
            </cite>
            , the returned matrix
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              P
             </span>
            </code>
            will be empty.
The LU decomposition without pivoting
            <a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition#Definitions">
             may not exist
            </a>
            if any of the principal minors of
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              A
             </span>
            </code>
            is singular.
In this case, the output matrix may contain
            <cite>
             inf
            </cite>
            or
            <cite>
             NaN
            </cite>
            .
           </p>
           <p>
            Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              A
             </span>
            </code>
            is a batch of matrices then
the output has the same batch dimensions.
           </p>
           <div class="admonition seealso">
            <p class="admonition-title">
             See also
            </p>
            <p>
             <a class="reference internal" href="torch.linalg.solve.html#torch.linalg.solve" title="torch.linalg.solve">
              <code class="xref py py-func docutils literal notranslate">
               <span class="pre">
                torch.linalg.solve()
               </span>
              </code>
             </a>
             solves a system of linear equations using the LU decomposition
with partial pivoting.
            </p>
           </div>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             The LU decomposition is almost never unique, as often there are different permutation
matrices that can yield different LU decompositions.
As such, different platforms, like SciPy, or inputs on different devices,
may produce different valid decompositions.
            </p>
           </div>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             Gradient computations are only supported if the input matrix is full-rank.
If this condition is not met, no error will be thrown, but the gradient
may not be finite.
This is because the LU decomposition with pivoting is not differentiable at these points.
            </p>
           </div>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 A
                </strong>
                (
                <a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">
                 <em>
                  Tensor
                 </em>
                </a>
                ) – tensor of shape
                <cite>
                 (*, m, n)
                </cite>
                where
                <cite>
                 *
                </cite>
                is zero or more batch dimensions.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 pivot
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – Controls whether to compute the LU decomposition with partial pivoting or
no pivoting. Default:
                <cite>
                 True
                </cite>
                .
               </p>
              </li>
             </ul>
            </dd>
            <dt class="field-even">
             Keyword Arguments
            </dt>
            <dd class="field-even">
             <p>
              <strong>
               out
              </strong>
              (
              <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
               <em>
                tuple
               </em>
              </a>
              <em>
               ,
              </em>
              <em>
               optional
              </em>
              ) – output tuple of three tensors. Ignored if
              <cite>
               None
              </cite>
              . Default:
              <cite>
               None
              </cite>
              .
             </p>
            </dd>
            <dt class="field-odd">
             Returns
            </dt>
            <dd class="field-odd">
             <p>
              A named tuple
              <cite>
               (P, L, U)
              </cite>
              .
             </p>
            </dd>
           </dl>
           <p>
            Examples:
           </p>
           <div class="highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">tensor([[0., 1., 0.],</span>
<span class="go">        [0., 0., 1.],</span>
<span class="go">        [1., 0., 0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span>
<span class="go">tensor([[1.0000, 0.0000],</span>
<span class="go">        [0.5007, 1.0000],</span>
<span class="go">        [0.0633, 0.9755]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U</span>
<span class="go">tensor([[0.3771, 0.0489],</span>
<span class="go">        [0.0000, 0.9644]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">P</span> <span class="o">@</span> <span class="n">L</span> <span class="o">@</span> <span class="n">U</span><span class="p">)</span>
<span class="go">tensor(5.9605e-08)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">"cuda"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">tensor([], device='cuda:0')</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">L</span> <span class="o">@</span> <span class="n">U</span><span class="p">)</span>
<span class="go">tensor(1.0376e-06, device='cuda:0')</span>
</pre>
            </div>
           </div>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>