<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   torch.linalg.qr — PyTorch 1.10 documentation
  </title>
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="torch-linalg-qr">
         <h1>
          torch.linalg.qr
          <a class="headerlink" href="#torch-linalg-qr" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py function">
          <dt id="torch.linalg.qr">
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.linalg.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             qr
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              A
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              mode
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              'reduced'
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="o">
             <span class="pre">
              *
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              out
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="headerlink" href="#torch.linalg.qr" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Computes the QR decomposition of a matrix.
           </p>
           <p>
            Letting
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   K
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{K}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68889em;vertical-align:0em;">
                </span>
                <span class="mord mathbb">
                 K
                </span>
               </span>
              </span>
             </span>
            </span>
            be
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   R
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{R}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68889em;vertical-align:0em;">
                </span>
                <span class="mord mathbb">
                 R
                </span>
               </span>
              </span>
             </span>
            </span>
            or
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi mathvariant="double-struck">
                   C
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \mathbb{C}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68889em;vertical-align:0em;">
                </span>
                <span class="mord mathbb">
                 C
                </span>
               </span>
              </span>
             </span>
            </span>
            ,
the
            <strong>
             full QR decomposition
            </strong>
            of a matrix
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   ∈
                  </mo>
                  <msup>
                   <mi mathvariant="double-struck">
                    K
                   </mi>
                   <mrow>
                    <mi>
                     m
                    </mi>
                    <mo>
                     ×
                    </mo>
                    <mi>
                     n
                    </mi>
                   </mrow>
                  </msup>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A \in \mathbb{K}^{m \times n}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.72243em;vertical-align:-0.0391em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
                <span class="mrel">
                 ∈
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:0.771331em;vertical-align:0em;">
                </span>
                <span class="mord">
                 <span class="mord mathbb">
                  K
                 </span>
                 <span class="msupsub">
                  <span class="vlist-t">
                   <span class="vlist-r">
                    <span class="vlist" style="height:0.771331em;">
                     <span style="top:-3.063em;margin-right:0.05em;">
                      <span class="pstrut" style="height:2.7em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mtight">
                        <span class="mord mathnormal mtight">
                         m
                        </span>
                        <span class="mbin mtight">
                         ×
                        </span>
                        <span class="mord mathnormal mtight">
                         n
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            is defined as
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   =
                  </mo>
                  <mi>
                   Q
                  </mi>
                  <mi>
                   R
                  </mi>
                  <mpadded width="0px">
                   <mrow>
                    <mspace width="2em">
                    </mspace>
                    <mi>
                     Q
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       m
                      </mi>
                     </mrow>
                    </msup>
                    <mo separator="true">
                     ,
                    </mo>
                    <mi>
                     R
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       n
                      </mi>
                     </mrow>
                    </msup>
                   </mrow>
                  </mpadded>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A = QR\mathrlap{\qquad Q \in \mathbb{K}^{m \times m}, R \in \mathbb{K}^{m \times n}}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68333em;vertical-align:0em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
                <span class="mrel">
                 =
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.015771em;vertical-align:-0.19444em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.00773em;">
                 QR
                </span>
                <span class="mord vbox">
                 <span class="thinbox">
                  <span class="rlap">
                   <span class="strut" style="height:1.015771em;vertical-align:-0.19444em;">
                   </span>
                   <span class="inner">
                    <span class="mord">
                     <span class="mspace" style="margin-right:2em;">
                     </span>
                     <span class="mord mathnormal">
                      Q
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.821331em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mpunct">
                      ,
                     </span>
                     <span class="mspace" style="margin-right:0.16666666666666666em;">
                     </span>
                     <span class="mord mathnormal" style="margin-right:0.00773em;">
                      R
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.821331em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="fix">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            where
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   Q
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  Q
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;">
                </span>
                <span class="mord mathnormal">
                 Q
                </span>
               </span>
              </span>
             </span>
            </span>
            is orthogonal in the real case and unitary in the complex case, and
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   R
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  R
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68333em;vertical-align:0em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.00773em;">
                 R
                </span>
               </span>
              </span>
             </span>
            </span>
            is upper triangular.
           </p>
           <p>
            When
            <cite>
             m &gt; n
            </cite>
            (tall matrix), as
            <cite>
             R
            </cite>
            is upper triangular, its last
            <cite>
             m - n
            </cite>
            rows are zero.
In this case, we can drop the last
            <cite>
             m - n
            </cite>
            columns of
            <cite>
             Q
            </cite>
            to form the
            <strong>
             reduced QR decomposition
            </strong>
            :
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   A
                  </mi>
                  <mo>
                   =
                  </mo>
                  <mi>
                   Q
                  </mi>
                  <mi>
                   R
                  </mi>
                  <mpadded width="0px">
                   <mrow>
                    <mspace width="2em">
                    </mspace>
                    <mi>
                     Q
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       m
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       n
                      </mi>
                     </mrow>
                    </msup>
                    <mo separator="true">
                     ,
                    </mo>
                    <mi>
                     R
                    </mi>
                    <mo>
                     ∈
                    </mo>
                    <msup>
                     <mi mathvariant="double-struck">
                      K
                     </mi>
                     <mrow>
                      <mi>
                       n
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mi>
                       n
                      </mi>
                     </mrow>
                    </msup>
                   </mrow>
                  </mpadded>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  A = QR\mathrlap{\qquad Q \in \mathbb{K}^{m \times n}, R \in \mathbb{K}^{n \times n}}
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.68333em;vertical-align:0em;">
                </span>
                <span class="mord mathnormal">
                 A
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
                <span class="mrel">
                 =
                </span>
                <span class="mspace" style="margin-right:0.2777777777777778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.015771em;vertical-align:-0.19444em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.00773em;">
                 QR
                </span>
                <span class="mord vbox">
                 <span class="thinbox">
                  <span class="rlap">
                   <span class="strut" style="height:1.015771em;vertical-align:-0.19444em;">
                   </span>
                   <span class="inner">
                    <span class="mord">
                     <span class="mspace" style="margin-right:2em;">
                     </span>
                     <span class="mord mathnormal">
                      Q
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.821331em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              m
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mpunct">
                      ,
                     </span>
                     <span class="mspace" style="margin-right:0.16666666666666666em;">
                     </span>
                     <span class="mord mathnormal" style="margin-right:0.00773em;">
                      R
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mrel">
                      ∈
                     </span>
                     <span class="mspace" style="margin-right:0.2777777777777778em;">
                     </span>
                     <span class="mord">
                      <span class="mord mathbb">
                       K
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height:0.821331em;">
                          <span style="top:-3.113em;margin-right:0.05em;">
                           <span class="pstrut" style="height:2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                             <span class="mbin mtight">
                              ×
                             </span>
                             <span class="mord mathnormal mtight">
                              n
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="fix">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            The reduced QR decomposition agrees with the full QR decomposition when
            <cite>
             n &gt;= m
            </cite>
            (wide matrix).
           </p>
           <p>
            Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              A
             </span>
            </code>
            is a batch of matrices then
the output has the same batch dimensions.
           </p>
           <p>
            The parameter
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              mode
             </span>
            </code>
            chooses between the full and reduced QR decomposition.
If
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              A
             </span>
            </code>
            has shape
            <cite>
             (*, m, n)
            </cite>
            , denoting
            <cite>
             k = min(m, n)
            </cite>
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                mode
               </span>
              </code>
              <cite>
               = ‘reduced’
              </cite>
              (default): Returns
              <cite>
               (Q, R)
              </cite>
              of shapes
              <cite>
               (*, m, k)
              </cite>
              ,
              <cite>
               (*, k, n)
              </cite>
              respectively.
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                mode
               </span>
              </code>
              <cite>
               = ‘complete’
              </cite>
              : Returns
              <cite>
               (Q, R)
              </cite>
              of shapes
              <cite>
               (*, m, m)
              </cite>
              ,
              <cite>
               (*, m, n)
              </cite>
              respectively.
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                mode
               </span>
              </code>
              <cite>
               = ‘r’
              </cite>
              : Computes only the reduced
              <cite>
               R
              </cite>
              . Returns
              <cite>
               (Q, R)
              </cite>
              with
              <cite>
               Q
              </cite>
              empty and
              <cite>
               R
              </cite>
              of shape
              <cite>
               (*, k, n)
              </cite>
              .
             </p>
            </li>
           </ul>
           <p>
            Differences with
            <cite>
             numpy.linalg.qr
            </cite>
            :
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                mode
               </span>
              </code>
              <cite>
               = ‘raw’
              </cite>
              is not implemented.
             </p>
            </li>
            <li>
             <p>
              Unlike
              <cite>
               numpy.linalg.qr
              </cite>
              , this function always returns a tuple of two tensors.
When
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                mode
               </span>
              </code>
              <cite>
               = ‘r’
              </cite>
              , the
              <cite>
               Q
              </cite>
              tensor is an empty tensor.
This behavior may change in a future PyTorch release.
             </p>
            </li>
           </ul>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             The elements in the diagonal of
             <cite>
              R
             </cite>
             are not necessarily positive.
            </p>
           </div>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <code class="xref py py-attr docutils literal notranslate">
              <span class="pre">
               mode
              </span>
             </code>
             <cite>
              = ‘r’
             </cite>
             does not support backpropagation. Use
             <code class="xref py py-attr docutils literal notranslate">
              <span class="pre">
               mode
              </span>
             </code>
             <cite>
              = ‘reduced’
             </cite>
             instead.
            </p>
           </div>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             The QR decomposition is only unique up to the sign of the diagonal of
             <cite>
              R
             </cite>
             when the
first
             <cite>
              k = min(m, n)
             </cite>
             columns of
             <code class="xref py py-attr docutils literal notranslate">
              <span class="pre">
               A
              </span>
             </code>
             are linearly independent.
If this is not the case, different platforms, like NumPy,
or inputs on different devices, may produce different valid decompositions.
            </p>
           </div>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             Gradient computations are only supported if the first
             <cite>
              k = min(m, n)
             </cite>
             columns
of every matrix in
             <code class="xref py py-attr docutils literal notranslate">
              <span class="pre">
               A
              </span>
             </code>
             are linearly independent.
If this condition is not met, no error will be thrown, but the gradient produced
will be incorrect.
This is because the QR decomposition is not differentiable at these points.
            </p>
           </div>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 A
                </strong>
                (
                <a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">
                 <em>
                  Tensor
                 </em>
                </a>
                ) – tensor of shape
                <cite>
                 (*, m, n)
                </cite>
                where
                <cite>
                 *
                </cite>
                is zero or more batch dimensions.
               </p>
              </li>
              <li>
               <p>
                <strong>
                 mode
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">
                 <em>
                  str
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – one of
                <cite>
                 ‘reduced’
                </cite>
                ,
                <cite>
                 ‘complete’
                </cite>
                ,
                <cite>
                 ‘r’
                </cite>
                .
Controls the shape of the returned tensors. Default:
                <cite>
                 ‘reduced’
                </cite>
                .
               </p>
              </li>
             </ul>
            </dd>
            <dt class="field-even">
             Keyword Arguments
            </dt>
            <dd class="field-even">
             <p>
              <strong>
               out
              </strong>
              (
              <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
               <em>
                tuple
               </em>
              </a>
              <em>
               ,
              </em>
              <em>
               optional
              </em>
              ) – output tuple of two tensors. Ignored if
              <cite>
               None
              </cite>
              . Default:
              <cite>
               None
              </cite>
              .
             </p>
            </dd>
            <dt class="field-odd">
             Returns
            </dt>
            <dd class="field-odd">
             <p>
              A named tuple
              <cite>
               (Q, R)
              </cite>
              .
             </p>
            </dd>
           </dl>
           <p>
            Examples:
           </p>
           <div class="highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">12.</span><span class="p">,</span> <span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="o">-</span><span class="mi">68</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span>
<span class="go">tensor([[-0.8571,  0.3943,  0.3314],</span>
<span class="go">        [-0.4286, -0.9029, -0.0343],</span>
<span class="go">        [ 0.2857, -0.1714,  0.9429]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span>
<span class="go">tensor([[ -14.0000,  -21.0000,   14.0000],</span>
<span class="go">        [   0.0000, -175.0000,   70.0000],</span>
<span class="go">        [   0.0000,    0.0000,  -35.0000]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Q</span> <span class="o">@</span> <span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">tensor([[  12.,  -51.,    4.],</span>
<span class="go">        [   6.,  167.,  -68.],</span>
<span class="go">        [  -4.,   24.,  -41.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">tensor([[ 1.,  0.,  0.],</span>
<span class="go">        [ 0.,  1., -0.],</span>
<span class="go">        [ 0., -0.,  1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q2</span><span class="p">,</span> <span class="n">R2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q2</span>
<span class="go">tensor([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">R2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'complete'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">Q</span> <span class="o">@</span> <span class="n">R</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">tensor(1.6099e-06)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">Q</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">tensor(6.2158e-07)</span>
</pre>
            </div>
           </div>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>