<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   AdaptiveLogSoftmaxWithLoss — PyTorch 1.12 documentation
  </title>
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="adaptivelogsoftmaxwithloss">
         <h1>
          AdaptiveLogSoftmaxWithLoss
          <a class="headerlink" href="#adaptivelogsoftmaxwithloss" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py class">
          <dt id="torch.nn.AdaptiveLogSoftmaxWithLoss">
           <em class="property">
            <span class="pre">
             class
            </span>
           </em>
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.nn.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             AdaptiveLogSoftmaxWithLoss
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              in_features
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              n_classes
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              cutoffs
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              div_value
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              4.0
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              head_bias
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              False
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              device
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              dtype
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              None
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="../_modules/torch/nn/modules/adaptive.html#AdaptiveLogSoftmaxWithLoss">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.nn.AdaptiveLogSoftmaxWithLoss" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Efficient softmax approximation as described in
            <a class="reference external" href="https://arxiv.org/abs/1609.04309">
             Efficient softmax approximation for GPUs by Edouard Grave, Armand Joulin,
Moustapha Cissé, David Grangier, and Hervé Jégou
            </a>
            .
           </p>
           <p>
            Adaptive softmax is an approximate strategy for training models with large
output spaces. It is most effective when the label distribution is highly
imbalanced, for example in natural language modelling, where the word
frequency distribution approximately follows the
            <a class="reference external" href="https://en.wikipedia.org/wiki/Zipf%27s_law">
             Zipf’s law
            </a>
            .
           </p>
           <p>
            Adaptive softmax partitions the labels into several clusters, according to
their frequency. These clusters may contain different number of targets
each.
Additionally, clusters containing less frequent labels assign lower
dimensional embeddings to those labels, which speeds up the computation.
For each minibatch, only clusters for which at least one target is
present are evaluated.
           </p>
           <p>
            The idea is that the clusters which are accessed frequently
(like the first one, containing most frequent labels), should also be cheap
to compute – that is, contain a small number of assigned labels.
           </p>
           <p>
            We highly recommend taking a look at the original paper for more details.
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                cutoffs
               </span>
              </code>
              should be an ordered Sequence of integers sorted
in the increasing order.
It controls number of clusters and the partitioning of targets into
clusters. For example setting
              <code class="docutils literal notranslate">
               <span class="pre">
                cutoffs
               </span>
               <span class="pre">
                =
               </span>
               <span class="pre">
                [10,
               </span>
               <span class="pre">
                100,
               </span>
               <span class="pre">
                1000]
               </span>
              </code>
              means that first
              <cite>
               10
              </cite>
              targets will be assigned
to the ‘head’ of the adaptive softmax, targets
              <cite>
               11, 12, …, 100
              </cite>
              will be
assigned to the first cluster, and targets
              <cite>
               101, 102, …, 1000
              </cite>
              will be
assigned to the second cluster, while targets
              <cite>
               1001, 1002, …, n_classes - 1
              </cite>
              will be assigned
to the last, third cluster.
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                div_value
               </span>
              </code>
              is used to compute the size of each additional cluster,
which is given as
              <span class="math">
               <span class="katex">
                <span class="katex-mathml">
                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                   <mrow>
                    <mo fence="true">
                     ⌊
                    </mo>
                    <mfrac>
                     <mtext mathvariant="monospace">
                      in_features
                     </mtext>
                     <msup>
                      <mtext mathvariant="monospace">
                       div_value
                      </mtext>
                      <mrow>
                       <mi>
                        i
                       </mi>
                       <mi>
                        d
                       </mi>
                       <mi>
                        x
                       </mi>
                      </mrow>
                     </msup>
                    </mfrac>
                    <mo fence="true">
                     ⌋
                    </mo>
                   </mrow>
                   <annotation encoding="application/x-tex">
                    \left\lfloor\frac{\texttt{in\_features}}{\texttt{div\_value}^{idx}}\right\rfloor
                   </annotation>
                  </semantics>
                 </math>
                </span>
                <span aria-hidden="true" class="katex-html">
                 <span class="base">
                  <span class="strut" style="height:1.8em;vertical-align:-0.65em;">
                  </span>
                  <span class="minner">
                   <span class="mopen delimcenter" style="top:0em;">
                    <span class="delimsizing size2">
                     ⌊
                    </span>
                   </span>
                   <span class="mord">
                    <span class="mopen nulldelimiter">
                    </span>
                    <span class="mfrac">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height:0.8218em;">
                        <span style="top:-2.6426em;">
                         <span class="pstrut" style="height:3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord text mtight">
                             <span class="mord texttt mtight">
                              div_value
                             </span>
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t">
                              <span class="vlist-r">
                               <span class="vlist" style="height:0.782em;">
                                <span style="top:-2.786em;margin-right:0.0714em;">
                                 <span class="pstrut" style="height:2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    i
                                   </span>
                                   <span class="mord mathnormal mtight">
                                    d
                                   </span>
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span style="top:-3.23em;">
                         <span class="pstrut" style="height:3em;">
                         </span>
                         <span class="frac-line" style="border-bottom-width:0.04em;">
                         </span>
                        </span>
                        <span style="top:-3.394em;">
                         <span class="pstrut" style="height:3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord text mtight">
                            <span class="mord texttt mtight">
                             in_features
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height:0.424em;">
                        <span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose nulldelimiter">
                    </span>
                   </span>
                   <span class="mclose delimcenter" style="top:0em;">
                    <span class="delimsizing size2">
                     ⌋
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              ,
where
              <span class="math">
               <span class="katex">
                <span class="katex-mathml">
                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                   <mrow>
                    <mi>
                     i
                    </mi>
                    <mi>
                     d
                    </mi>
                    <mi>
                     x
                    </mi>
                   </mrow>
                   <annotation encoding="application/x-tex">
                    idx
                   </annotation>
                  </semantics>
                 </math>
                </span>
                <span aria-hidden="true" class="katex-html">
                 <span class="base">
                  <span class="strut" style="height:0.6944em;">
                  </span>
                  <span class="mord mathnormal">
                   i
                  </span>
                  <span class="mord mathnormal">
                   d
                  </span>
                  <span class="mord mathnormal">
                   x
                  </span>
                 </span>
                </span>
               </span>
              </span>
              is the cluster index (with clusters
for less frequent words having larger indices,
and indices starting from
              <span class="math">
               <span class="katex">
                <span class="katex-mathml">
                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                   <mrow>
                    <mn>
                     1
                    </mn>
                   </mrow>
                   <annotation encoding="application/x-tex">
                    1
                   </annotation>
                  </semantics>
                 </math>
                </span>
                <span aria-hidden="true" class="katex-html">
                 <span class="base">
                  <span class="strut" style="height:0.6444em;">
                  </span>
                  <span class="mord">
                   1
                  </span>
                 </span>
                </span>
               </span>
              </span>
              ).
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                head_bias
               </span>
              </code>
              if set to True, adds a bias term to the ‘head’ of the
adaptive softmax. See paper for details. Set to False in the official
implementation.
             </p>
            </li>
           </ul>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             Labels passed as inputs to this module should be sorted according to
their frequency. This means that the most frequent label should be
represented by the index
             <cite>
              0
             </cite>
             , and the least frequent
label should be represented by the index
             <cite>
              n_classes - 1
             </cite>
             .
            </p>
           </div>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             This module returns a
             <code class="docutils literal notranslate">
              <span class="pre">
               NamedTuple
              </span>
             </code>
             with
             <code class="docutils literal notranslate">
              <span class="pre">
               output
              </span>
             </code>
             and
             <code class="docutils literal notranslate">
              <span class="pre">
               loss
              </span>
             </code>
             fields. See further documentation for details.
            </p>
           </div>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             To compute log-probabilities for all classes, the
             <code class="docutils literal notranslate">
              <span class="pre">
               log_prob
              </span>
             </code>
             method can be used.
            </p>
           </div>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 in_features
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – Number of features in the input tensor
               </p>
              </li>
              <li>
               <p>
                <strong>
                 n_classes
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                ) – Number of classes in the dataset
               </p>
              </li>
              <li>
               <p>
                <strong>
                 cutoffs
                </strong>
                (
                <em>
                 Sequence
                </em>
                ) – Cutoffs used to assign targets to their buckets
               </p>
              </li>
              <li>
               <p>
                <strong>
                 div_value
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">
                 <em>
                  float
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – value used as an exponent to compute sizes
of the clusters. Default: 4.0
               </p>
              </li>
              <li>
               <p>
                <strong>
                 head_bias
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">
                 <em>
                  bool
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – If
                <code class="docutils literal notranslate">
                 <span class="pre">
                  True
                 </span>
                </code>
                , adds a bias term to the ‘head’ of the
adaptive softmax. Default:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  False
                 </span>
                </code>
               </p>
              </li>
             </ul>
            </dd>
            <dt class="field-even">
             Returns
            </dt>
            <dd class="field-even">
             <p>
              <ul class="simple">
               <li>
                <p>
                 <strong>
                  output
                 </strong>
                 is a Tensor of size
                 <code class="docutils literal notranslate">
                  <span class="pre">
                   N
                  </span>
                 </code>
                 containing computed target
log probabilities for each example
                </p>
               </li>
               <li>
                <p>
                 <strong>
                  loss
                 </strong>
                 is a Scalar representing the computed negative
log likelihood loss
                </p>
               </li>
              </ul>
             </p>
            </dd>
            <dt class="field-odd">
             Return type
            </dt>
            <dd class="field-odd">
             <p>
              <code class="docutils literal notranslate">
               <span class="pre">
                NamedTuple
               </span>
              </code>
              with
              <code class="docutils literal notranslate">
               <span class="pre">
                output
               </span>
              </code>
              and
              <code class="docutils literal notranslate">
               <span class="pre">
                loss
               </span>
              </code>
              fields
             </p>
            </dd>
           </dl>
           <dl class="simple">
            <dt>
             Shape:
            </dt>
            <dd>
             <ul class="simple">
              <li>
               <p>
                input:
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       N
                      </mi>
                      <mo separator="true">
                       ,
                      </mo>
                      <mtext mathvariant="monospace">
                       in_features
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (N, \texttt{in\_features})
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.10903em;">
                     N
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      in_features
                     </span>
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                or
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mtext mathvariant="monospace">
                       in_features
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (\texttt{in\_features})
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      in_features
                     </span>
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </p>
              </li>
              <li>
               <p>
                target:
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       N
                      </mi>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (N)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.10903em;">
                     N
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                or
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      ()
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                where each value satisfies
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mn>
                       0
                      </mn>
                      <mo>
                       &lt;
                      </mo>
                      <mo>
                       =
                      </mo>
                      <mtext mathvariant="monospace">
                       target[i]
                      </mtext>
                      <mo>
                       &lt;
                      </mo>
                      <mo>
                       =
                      </mo>
                      <mtext mathvariant="monospace">
                       n_classes
                      </mtext>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      0 &lt;= \texttt{target[i]} &lt;= \texttt{n\_classes}
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:0.6835em;vertical-align:-0.0391em;">
                    </span>
                    <span class="mord">
                     0
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                    <span class="mrel">
                     &lt;=
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:0.9167em;vertical-align:-0.2222em;">
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      target[i]
                     </span>
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                    <span class="mrel">
                     &lt;=
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:0.7063em;vertical-align:-0.0951em;">
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      n_classes
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </p>
              </li>
              <li>
               <p>
                output1:
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       N
                      </mi>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (N)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.10903em;">
                     N
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                or
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      ()
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </p>
              </li>
              <li>
               <p>
                output2:
                <code class="docutils literal notranslate">
                 <span class="pre">
                  Scalar
                 </span>
                </code>
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.nn.AdaptiveLogSoftmaxWithLoss.log_prob">
             <code class="sig-name descname">
              <span class="pre">
               log_prob
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                input
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="../_modules/torch/nn/modules/adaptive.html#AdaptiveLogSoftmaxWithLoss.log_prob">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.nn.AdaptiveLogSoftmaxWithLoss.log_prob" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              Computes log probabilities for all
              <span class="math">
               <span class="katex">
                <span class="katex-mathml">
                 <math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                   <mrow>
                    <mtext mathvariant="monospace">
                     n_classes
                    </mtext>
                   </mrow>
                   <annotation encoding="application/x-tex">
                    \texttt{n\_classes}
                   </annotation>
                  </semantics>
                 </math>
                </span>
                <span aria-hidden="true" class="katex-html">
                 <span class="base">
                  <span class="strut" style="height:0.7063em;vertical-align:-0.0951em;">
                  </span>
                  <span class="mord text">
                   <span class="mord texttt">
                    n_classes
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 input
                </strong>
                (
                <a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">
                 <em>
                  Tensor
                 </em>
                </a>
                ) – a minibatch of examples
               </p>
              </dd>
              <dt class="field-even">
               Returns
              </dt>
              <dd class="field-even">
               <p>
                log-probabilities of for each class
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mi>
                       c
                      </mi>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      c
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:0.4306em;">
                    </span>
                    <span class="mord mathnormal">
                     c
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                in range
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mn>
                       0
                      </mn>
                      <mo>
                       &lt;
                      </mo>
                      <mo>
                       =
                      </mo>
                      <mi>
                       c
                      </mi>
                      <mo>
                       &lt;
                      </mo>
                      <mo>
                       =
                      </mo>
                      <mtext mathvariant="monospace">
                       n_classes
                      </mtext>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      0 &lt;= c &lt;= \texttt{n\_classes}
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:0.6835em;vertical-align:-0.0391em;">
                    </span>
                    <span class="mord">
                     0
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                    <span class="mrel">
                     &lt;=
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:0.5782em;vertical-align:-0.0391em;">
                    </span>
                    <span class="mord mathnormal">
                     c
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                    <span class="mrel">
                     &lt;=
                    </span>
                    <span class="mspace" style="margin-right:0.2778em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:0.7063em;vertical-align:-0.0951em;">
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      n_classes
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                , where
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mtext mathvariant="monospace">
                       n_classes
                      </mtext>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      \texttt{n\_classes}
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:0.7063em;vertical-align:-0.0951em;">
                    </span>
                    <span class="mord text">
                     <span class="mord texttt">
                      n_classes
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                is a
parameter passed to
                <code class="docutils literal notranslate">
                 <span class="pre">
                  AdaptiveLogSoftmaxWithLoss
                 </span>
                </code>
                constructor.
               </p>
              </dd>
             </dl>
             <dl class="simple">
              <dt>
               Shape:
              </dt>
              <dd>
               <ul class="simple">
                <li>
                 <p>
                  Input:
                  <span class="math">
                   <span class="katex">
                    <span class="katex-mathml">
                     <math xmlns="http://www.w3.org/1998/Math/MathML">
                      <semantics>
                       <mrow>
                        <mo stretchy="false">
                         (
                        </mo>
                        <mi>
                         N
                        </mi>
                        <mo separator="true">
                         ,
                        </mo>
                        <mtext mathvariant="monospace">
                         in_features
                        </mtext>
                        <mo stretchy="false">
                         )
                        </mo>
                       </mrow>
                       <annotation encoding="application/x-tex">
                        (N, \texttt{in\_features})
                       </annotation>
                      </semantics>
                     </math>
                    </span>
                    <span aria-hidden="true" class="katex-html">
                     <span class="base">
                      <span class="strut" style="height:1em;vertical-align:-0.25em;">
                      </span>
                      <span class="mopen">
                       (
                      </span>
                      <span class="mord mathnormal" style="margin-right:0.10903em;">
                       N
                      </span>
                      <span class="mpunct">
                       ,
                      </span>
                      <span class="mspace" style="margin-right:0.1667em;">
                      </span>
                      <span class="mord text">
                       <span class="mord texttt">
                        in_features
                       </span>
                      </span>
                      <span class="mclose">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </p>
                </li>
                <li>
                 <p>
                  Output:
                  <span class="math">
                   <span class="katex">
                    <span class="katex-mathml">
                     <math xmlns="http://www.w3.org/1998/Math/MathML">
                      <semantics>
                       <mrow>
                        <mo stretchy="false">
                         (
                        </mo>
                        <mi>
                         N
                        </mi>
                        <mo separator="true">
                         ,
                        </mo>
                        <mtext mathvariant="monospace">
                         n_classes
                        </mtext>
                        <mo stretchy="false">
                         )
                        </mo>
                       </mrow>
                       <annotation encoding="application/x-tex">
                        (N, \texttt{n\_classes})
                       </annotation>
                      </semantics>
                     </math>
                    </span>
                    <span aria-hidden="true" class="katex-html">
                     <span class="base">
                      <span class="strut" style="height:1em;vertical-align:-0.25em;">
                      </span>
                      <span class="mopen">
                       (
                      </span>
                      <span class="mord mathnormal" style="margin-right:0.10903em;">
                       N
                      </span>
                      <span class="mpunct">
                       ,
                      </span>
                      <span class="mspace" style="margin-right:0.1667em;">
                      </span>
                      <span class="mord text">
                       <span class="mord texttt">
                        n_classes
                       </span>
                      </span>
                      <span class="mclose">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </p>
                </li>
               </ul>
              </dd>
             </dl>
            </dd>
           </dl>
           <dl class="py method">
            <dt id="torch.nn.AdaptiveLogSoftmaxWithLoss.predict">
             <code class="sig-name descname">
              <span class="pre">
               predict
              </span>
             </code>
             <span class="sig-paren">
              (
             </span>
             <em class="sig-param">
              <span class="n">
               <span class="pre">
                input
               </span>
              </span>
             </em>
             <span class="sig-paren">
              )
             </span>
             <a class="reference internal" href="../_modules/torch/nn/modules/adaptive.html#AdaptiveLogSoftmaxWithLoss.predict">
              <span class="viewcode-link">
               <span class="pre">
                [source]
               </span>
              </span>
             </a>
             <a class="headerlink" href="#torch.nn.AdaptiveLogSoftmaxWithLoss.predict" title="Permalink to this definition">
              ¶
             </a>
            </dt>
            <dd>
             <p>
              This is equivalent to
              <cite>
               self.log_prob(input).argmax(dim=1)
              </cite>
              ,
but is more efficient in some cases.
             </p>
             <dl class="field-list simple">
              <dt class="field-odd">
               Parameters
              </dt>
              <dd class="field-odd">
               <p>
                <strong>
                 input
                </strong>
                (
                <a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">
                 <em>
                  Tensor
                 </em>
                </a>
                ) – a minibatch of examples
               </p>
              </dd>
              <dt class="field-even">
               Returns
              </dt>
              <dd class="field-even">
               <p>
                a class with the highest probability for each example
               </p>
              </dd>
              <dt class="field-odd">
               Return type
              </dt>
              <dd class="field-odd">
               <p>
                output (
                <a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">
                 Tensor
                </a>
                )
               </p>
              </dd>
             </dl>
             <dl class="simple">
              <dt>
               Shape:
              </dt>
              <dd>
               <ul class="simple">
                <li>
                 <p>
                  Input:
                  <span class="math">
                   <span class="katex">
                    <span class="katex-mathml">
                     <math xmlns="http://www.w3.org/1998/Math/MathML">
                      <semantics>
                       <mrow>
                        <mo stretchy="false">
                         (
                        </mo>
                        <mi>
                         N
                        </mi>
                        <mo separator="true">
                         ,
                        </mo>
                        <mtext mathvariant="monospace">
                         in_features
                        </mtext>
                        <mo stretchy="false">
                         )
                        </mo>
                       </mrow>
                       <annotation encoding="application/x-tex">
                        (N, \texttt{in\_features})
                       </annotation>
                      </semantics>
                     </math>
                    </span>
                    <span aria-hidden="true" class="katex-html">
                     <span class="base">
                      <span class="strut" style="height:1em;vertical-align:-0.25em;">
                      </span>
                      <span class="mopen">
                       (
                      </span>
                      <span class="mord mathnormal" style="margin-right:0.10903em;">
                       N
                      </span>
                      <span class="mpunct">
                       ,
                      </span>
                      <span class="mspace" style="margin-right:0.1667em;">
                      </span>
                      <span class="mord text">
                       <span class="mord texttt">
                        in_features
                       </span>
                      </span>
                      <span class="mclose">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </p>
                </li>
                <li>
                 <p>
                  Output:
                  <span class="math">
                   <span class="katex">
                    <span class="katex-mathml">
                     <math xmlns="http://www.w3.org/1998/Math/MathML">
                      <semantics>
                       <mrow>
                        <mo stretchy="false">
                         (
                        </mo>
                        <mi>
                         N
                        </mi>
                        <mo stretchy="false">
                         )
                        </mo>
                       </mrow>
                       <annotation encoding="application/x-tex">
                        (N)
                       </annotation>
                      </semantics>
                     </math>
                    </span>
                    <span aria-hidden="true" class="katex-html">
                     <span class="base">
                      <span class="strut" style="height:1em;vertical-align:-0.25em;">
                      </span>
                      <span class="mopen">
                       (
                      </span>
                      <span class="mord mathnormal" style="margin-right:0.10903em;">
                       N
                      </span>
                      <span class="mclose">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </p>
                </li>
               </ul>
              </dd>
             </dl>
            </dd>
           </dl>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>