<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
 <!--<![endif]-->
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Fold — PyTorch 1.12 documentation
  </title>
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <!-- Google Analytics -->
  <!-- End Google Analytics -->
  <!-- Preload the theme fonts -->
  <!-- Preload the katex fonts -->
 </head>
 <body class="pytorch-body">
  <div class="pytorch-container">
   <section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
    <div class="pytorch-content-left">
     <div class="rst-content">
      <div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
        <div class="section" id="fold">
         <h1>
          Fold
          <a class="headerlink" href="#fold" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <dl class="py class">
          <dt id="torch.nn.Fold">
           <em class="property">
            <span class="pre">
             class
            </span>
           </em>
           <code class="sig-prename descclassname">
            <span class="pre">
             torch.nn.
            </span>
           </code>
           <code class="sig-name descname">
            <span class="pre">
             Fold
            </span>
           </code>
           <span class="sig-paren">
            (
           </span>
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              output_size
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              kernel_size
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              dilation
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              1
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              padding
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              0
             </span>
            </span>
           </em>
           ,
           <em class="sig-param">
            <span class="n">
             <span class="pre">
              stride
             </span>
            </span>
            <span class="o">
             <span class="pre">
              =
             </span>
            </span>
            <span class="default_value">
             <span class="pre">
              1
             </span>
            </span>
           </em>
           <span class="sig-paren">
            )
           </span>
           <a class="reference internal" href="../_modules/torch/nn/modules/fold.html#Fold">
            <span class="viewcode-link">
             <span class="pre">
              [source]
             </span>
            </span>
           </a>
           <a class="headerlink" href="#torch.nn.Fold" title="Permalink to this definition">
            ¶
           </a>
          </dt>
          <dd>
           <p>
            Combines an array of sliding local blocks into a large containing
tensor.
           </p>
           <p>
            Consider a batched
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              input
             </span>
            </code>
            tensor containing sliding local blocks,
e.g., patches of images, of shape
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mi>
                   N
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   C
                  </mi>
                  <mo>
                   ×
                  </mo>
                  <mo>
                   ∏
                  </mo>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mtext>
                   kernel_size
                  </mtext>
                  <mo stretchy="false">
                   )
                  </mo>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   L
                  </mi>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  (N, C \times  \prod(\text{kernel\_size}), L)
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:1em;vertical-align:-0.25em;">
                </span>
                <span class="mopen">
                 (
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 N
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.07153em;">
                 C
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
                <span class="mbin">
                 ×
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                </span>
                <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                 ∏
                </span>
                <span class="mopen">
                 (
                </span>
                <span class="mord text">
                 <span class="mord">
                  kernel_size
                 </span>
                </span>
                <span class="mclose">
                 )
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mord mathnormal">
                 L
                </span>
                <span class="mclose">
                 )
                </span>
               </span>
              </span>
             </span>
            </span>
            ,
where
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   N
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  N
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 N
                </span>
               </span>
              </span>
             </span>
            </span>
            is batch dimension,
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   C
                  </mi>
                  <mo>
                   ×
                  </mo>
                  <mo>
                   ∏
                  </mo>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mtext>
                   kernel_size
                  </mtext>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  C \times \prod(\text{kernel\_size})
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.7667em;vertical-align:-0.0833em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.07153em;">
                 C
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
                <span class="mbin">
                 ×
                </span>
                <span class="mspace" style="margin-right:0.2222em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                </span>
                <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                 ∏
                </span>
                <span class="mopen">
                 (
                </span>
                <span class="mord text">
                 <span class="mord">
                  kernel_size
                 </span>
                </span>
                <span class="mclose">
                 )
                </span>
               </span>
              </span>
             </span>
            </span>
            is the number of values within a block (a block has
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mo>
                   ∏
                  </mo>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mtext>
                   kernel_size
                  </mtext>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  \prod(\text{kernel\_size})
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                </span>
                <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                 ∏
                </span>
                <span class="mopen">
                 (
                </span>
                <span class="mord text">
                 <span class="mord">
                  kernel_size
                 </span>
                </span>
                <span class="mclose">
                 )
                </span>
               </span>
              </span>
             </span>
            </span>
            spatial locations each containing a
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   C
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  C
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.07153em;">
                 C
                </span>
               </span>
              </span>
             </span>
            </span>
            -channeled vector), and
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   L
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  L
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal">
                 L
                </span>
               </span>
              </span>
             </span>
            </span>
            is the total number of blocks. (This is exactly the
same specification as the output shape of
            <a class="reference internal" href="torch.nn.Unfold.html#torch.nn.Unfold" title="torch.nn.Unfold">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Unfold
              </span>
             </code>
            </a>
            .) This
operation combines these local blocks into the large
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              output
             </span>
            </code>
            tensor
of shape
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mo stretchy="false">
                   (
                  </mo>
                  <mi>
                   N
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mi>
                   C
                  </mi>
                  <mo separator="true">
                   ,
                  </mo>
                  <mtext>
                   output_size
                  </mtext>
                  <mo stretchy="false">
                   [
                  </mo>
                  <mn>
                   0
                  </mn>
                  <mo stretchy="false">
                   ]
                  </mo>
                  <mo separator="true">
                   ,
                  </mo>
                  <mtext>
                   output_size
                  </mtext>
                  <mo stretchy="false">
                   [
                  </mo>
                  <mn>
                   1
                  </mn>
                  <mo stretchy="false">
                   ]
                  </mo>
                  <mo separator="true">
                   ,
                  </mo>
                  <mo>
                   …
                  </mo>
                  <mtext>
                  </mtext>
                  <mo stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  (N, C, \text{output\_size}[0], \text{output\_size}[1], \dots)
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                </span>
                <span class="mopen">
                 (
                </span>
                <span class="mord mathnormal" style="margin-right:0.10903em;">
                 N
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mord mathnormal" style="margin-right:0.07153em;">
                 C
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mord text">
                 <span class="mord">
                  output_size
                 </span>
                </span>
                <span class="mopen">
                 [
                </span>
                <span class="mord">
                 0
                </span>
                <span class="mclose">
                 ]
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mord text">
                 <span class="mord">
                  output_size
                 </span>
                </span>
                <span class="mopen">
                 [
                </span>
                <span class="mord">
                 1
                </span>
                <span class="mclose">
                 ]
                </span>
                <span class="mpunct">
                 ,
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="minner">
                 …
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mclose">
                 )
                </span>
               </span>
              </span>
             </span>
            </span>
            by summing the overlapping values. Similar to
            <a class="reference internal" href="torch.nn.Unfold.html#torch.nn.Unfold" title="torch.nn.Unfold">
             <code class="xref py py-class docutils literal notranslate">
              <span class="pre">
               Unfold
              </span>
             </code>
            </a>
            , the
arguments must satisfy
           </p>
           <div class="math">
            <span class="katex-display">
             <span class="katex">
              <span class="katex-mathml">
               <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   L
                  </mi>
                  <mo>
                   =
                  </mo>
                  <munder>
                   <mo>
                    ∏
                   </mo>
                   <mi>
                    d
                   </mi>
                  </munder>
                  <mrow>
                   <mo fence="true">
                    ⌊
                   </mo>
                   <mfrac>
                    <mrow>
                     <mtext>
                      output_size
                     </mtext>
                     <mo stretchy="false">
                      [
                     </mo>
                     <mi>
                      d
                     </mi>
                     <mo stretchy="false">
                      ]
                     </mo>
                     <mo>
                      +
                     </mo>
                     <mn>
                      2
                     </mn>
                     <mo>
                      ×
                     </mo>
                     <mtext>
                      padding
                     </mtext>
                     <mo stretchy="false">
                      [
                     </mo>
                     <mi>
                      d
                     </mi>
                     <mo stretchy="false">
                      ]
                     </mo>
                     <mo>
                      −
                     </mo>
                     <mtext>
                      dilation
                     </mtext>
                     <mo stretchy="false">
                      [
                     </mo>
                     <mi>
                      d
                     </mi>
                     <mo stretchy="false">
                      ]
                     </mo>
                     <mo>
                      ×
                     </mo>
                     <mo stretchy="false">
                      (
                     </mo>
                     <mtext>
                      kernel_size
                     </mtext>
                     <mo stretchy="false">
                      [
                     </mo>
                     <mi>
                      d
                     </mi>
                     <mo stretchy="false">
                      ]
                     </mo>
                     <mo>
                      −
                     </mo>
                     <mn>
                      1
                     </mn>
                     <mo stretchy="false">
                      )
                     </mo>
                     <mo>
                      −
                     </mo>
                     <mn>
                      1
                     </mn>
                    </mrow>
                    <mrow>
                     <mtext>
                      stride
                     </mtext>
                     <mo stretchy="false">
                      [
                     </mo>
                     <mi>
                      d
                     </mi>
                     <mo stretchy="false">
                      ]
                     </mo>
                    </mrow>
                   </mfrac>
                   <mo>
                    +
                   </mo>
                   <mn>
                    1
                   </mn>
                   <mo fence="true">
                    ⌋
                   </mo>
                  </mrow>
                  <mo separator="true">
                   ,
                  </mo>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  L = \prod_d \left\lfloor\frac{\text{output\_size}[d] + 2 \times \text{padding}[d] %
    - \text{dilation}[d] \times (\text{kernel\_size}[d] - 1) - 1}{\text{stride}[d]} + 1\right\rfloor,
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6833em;">
                </span>
                <span class="mord mathnormal">
                 L
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
                <span class="mrel">
                 =
                </span>
                <span class="mspace" style="margin-right:0.2778em;">
                </span>
               </span>
               <span class="base">
                <span class="strut" style="height:2.7521em;vertical-align:-1.3021em;">
                </span>
                <span class="mop op-limits">
                 <span class="vlist-t vlist-t2">
                  <span class="vlist-r">
                   <span class="vlist" style="height:1.05em;">
                    <span style="top:-1.8479em;margin-left:0em;">
                     <span class="pstrut" style="height:3.05em;">
                     </span>
                     <span class="sizing reset-size6 size3 mtight">
                      <span class="mord mathnormal mtight">
                       d
                      </span>
                     </span>
                    </span>
                    <span style="top:-3.05em;">
                     <span class="pstrut" style="height:3.05em;">
                     </span>
                     <span>
                      <span class="mop op-symbol large-op">
                       ∏
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="vlist-s">
                    ​
                   </span>
                  </span>
                  <span class="vlist-r">
                   <span class="vlist" style="height:1.3021em;">
                    <span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="minner">
                 <span class="mopen delimcenter" style="top:0em;">
                  <span class="delimsizing size3">
                   ⌊
                  </span>
                 </span>
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height:1.45em;">
                      <span style="top:-2.314em;">
                       <span class="pstrut" style="height:3em;">
                       </span>
                       <span class="mord">
                        <span class="mord text">
                         <span class="mord">
                          stride
                         </span>
                        </span>
                        <span class="mopen">
                         [
                        </span>
                        <span class="mord mathnormal">
                         d
                        </span>
                        <span class="mclose">
                         ]
                        </span>
                       </span>
                      </span>
                      <span style="top:-3.23em;">
                       <span class="pstrut" style="height:3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width:0.04em;">
                       </span>
                      </span>
                      <span style="top:-3.7em;">
                       <span class="pstrut" style="height:3em;">
                       </span>
                       <span class="mord">
                        <span class="mord text">
                         <span class="mord">
                          output_size
                         </span>
                        </span>
                        <span class="mopen">
                         [
                        </span>
                        <span class="mord mathnormal">
                         d
                        </span>
                        <span class="mclose">
                         ]
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         +
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mord">
                         2
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         ×
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mord text">
                         <span class="mord">
                          padding
                         </span>
                        </span>
                        <span class="mopen">
                         [
                        </span>
                        <span class="mord mathnormal">
                         d
                        </span>
                        <span class="mclose">
                         ]
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mord text">
                         <span class="mord">
                          dilation
                         </span>
                        </span>
                        <span class="mopen">
                         [
                        </span>
                        <span class="mord mathnormal">
                         d
                        </span>
                        <span class="mclose">
                         ]
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         ×
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mopen">
                         (
                        </span>
                        <span class="mord text">
                         <span class="mord">
                          kernel_size
                         </span>
                        </span>
                        <span class="mopen">
                         [
                        </span>
                        <span class="mord mathnormal">
                         d
                        </span>
                        <span class="mclose">
                         ]
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mord">
                         1
                        </span>
                        <span class="mclose">
                         )
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mbin">
                         −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;">
                        </span>
                        <span class="mord">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height:0.936em;">
                      <span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                 <span class="mspace" style="margin-right:0.2222em;">
                 </span>
                 <span class="mbin">
                  +
                 </span>
                 <span class="mspace" style="margin-right:0.2222em;">
                 </span>
                 <span class="mord">
                  1
                 </span>
                 <span class="mclose delimcenter" style="top:0em;">
                  <span class="delimsizing size3">
                   ⌋
                  </span>
                 </span>
                </span>
                <span class="mspace" style="margin-right:0.1667em;">
                </span>
                <span class="mpunct">
                 ,
                </span>
               </span>
              </span>
             </span>
            </span>
           </div>
           <p>
            where
            <span class="math">
             <span class="katex">
              <span class="katex-mathml">
               <math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                 <mrow>
                  <mi>
                   d
                  </mi>
                 </mrow>
                 <annotation encoding="application/x-tex">
                  d
                 </annotation>
                </semantics>
               </math>
              </span>
              <span aria-hidden="true" class="katex-html">
               <span class="base">
                <span class="strut" style="height:0.6944em;">
                </span>
                <span class="mord mathnormal">
                 d
                </span>
               </span>
              </span>
             </span>
            </span>
            is over all spatial dimensions.
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                output_size
               </span>
              </code>
              describes the spatial shape of the large containing
tensor of the sliding local blocks. It is useful to resolve the ambiguity
when multiple input shapes map to same number of sliding blocks, e.g.,
with
              <code class="docutils literal notranslate">
               <span class="pre">
                stride
               </span>
               <span class="pre">
                &gt;
               </span>
               <span class="pre">
                0
               </span>
              </code>
              .
             </p>
            </li>
           </ul>
           <p>
            The
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              padding
             </span>
            </code>
            ,
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              stride
             </span>
            </code>
            and
            <code class="xref py py-attr docutils literal notranslate">
             <span class="pre">
              dilation
             </span>
            </code>
            arguments specify
how the sliding blocks are retrieved.
           </p>
           <ul class="simple">
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                stride
               </span>
              </code>
              controls the stride for the sliding blocks.
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                padding
               </span>
              </code>
              controls the amount of implicit zero-paddings on both
sides for
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                padding
               </span>
              </code>
              number of points for each dimension before
reshaping.
             </p>
            </li>
            <li>
             <p>
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                dilation
               </span>
              </code>
              controls the spacing between the kernel points; also known as the à trous algorithm.
It is harder to describe, but this
              <a class="reference external" href="https://github.com/vdumoulin/conv_arithmetic/blob/master/README.md">
               link
              </a>
              has a nice visualization of what
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                dilation
               </span>
              </code>
              does.
             </p>
            </li>
           </ul>
           <dl class="field-list simple">
            <dt class="field-odd">
             Parameters
            </dt>
            <dd class="field-odd">
             <ul class="simple">
              <li>
               <p>
                <strong>
                 output_size
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
                 <em>
                  tuple
                 </em>
                </a>
                ) – the shape of the spatial dimensions of the
output (i.e.,
                <code class="docutils literal notranslate">
                 <span class="pre">
                  output.sizes()[2:]
                 </span>
                </code>
                )
               </p>
              </li>
              <li>
               <p>
                <strong>
                 kernel_size
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
                 <em>
                  tuple
                 </em>
                </a>
                ) – the size of the sliding blocks
               </p>
              </li>
              <li>
               <p>
                <strong>
                 stride
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
                 <em>
                  tuple
                 </em>
                </a>
                ) – the stride of the sliding blocks in the input
spatial dimensions. Default: 1
               </p>
              </li>
              <li>
               <p>
                <strong>
                 padding
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
                 <em>
                  tuple
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – implicit zero padding to be added on
both sides of input. Default: 0
               </p>
              </li>
              <li>
               <p>
                <strong>
                 dilation
                </strong>
                (
                <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">
                 <em>
                  int
                 </em>
                </a>
                <em>
                 or
                </em>
                <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">
                 <em>
                  tuple
                 </em>
                </a>
                <em>
                 ,
                </em>
                <em>
                 optional
                </em>
                ) – a parameter that controls the
stride of elements within the
neighborhood. Default: 1
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <ul class="simple">
            <li>
             <p>
              If
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                output_size
               </span>
              </code>
              ,
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                kernel_size
               </span>
              </code>
              ,
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                dilation
               </span>
              </code>
              ,
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                padding
               </span>
              </code>
              or
              <code class="xref py py-attr docutils literal notranslate">
               <span class="pre">
                stride
               </span>
              </code>
              is an int or a tuple of length 1 then
their values will be replicated across all spatial dimensions.
             </p>
            </li>
            <li>
             <p>
              For the case of two output spatial dimensions this operation is sometimes
called
              <code class="docutils literal notranslate">
               <span class="pre">
                col2im
               </span>
              </code>
              .
             </p>
            </li>
           </ul>
           <div class="admonition note">
            <p class="admonition-title">
             Note
            </p>
            <p>
             <a class="reference internal" href="#torch.nn.Fold" title="torch.nn.Fold">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                Fold
               </span>
              </code>
             </a>
             calculates each combined value in the resulting
large tensor by summing all values from all containing blocks.
             <a class="reference internal" href="torch.nn.Unfold.html#torch.nn.Unfold" title="torch.nn.Unfold">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                Unfold
               </span>
              </code>
             </a>
             extracts the values in the local blocks by
copying from the large tensor. So, if the blocks overlap, they are not
inverses of each other.
            </p>
            <p>
             In general, folding and unfolding operations are related as
follows. Consider
             <a class="reference internal" href="#torch.nn.Fold" title="torch.nn.Fold">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                Fold
               </span>
              </code>
             </a>
             and
             <a class="reference internal" href="torch.nn.Unfold.html#torch.nn.Unfold" title="torch.nn.Unfold">
              <code class="xref py py-class docutils literal notranslate">
               <span class="pre">
                Unfold
               </span>
              </code>
             </a>
             instances created with the same
parameters:
            </p>
            <div class="doctest highlight-default notranslate">
             <div class="highlight">
              <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fold_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=...</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=...</span><span class="p">,</span> <span class="n">padding</span><span class="o">=...</span><span class="p">,</span> <span class="n">stride</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fold</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Fold</span><span class="p">(</span><span class="n">output_size</span><span class="o">=...</span><span class="p">,</span> <span class="o">**</span><span class="n">fold_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unfold</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Unfold</span><span class="p">(</span><span class="o">**</span><span class="n">fold_params</span><span class="p">)</span>
</pre>
             </div>
            </div>
            <p>
             Then for any (supported)
             <code class="docutils literal notranslate">
              <span class="pre">
               input
              </span>
             </code>
             tensor the following
equality holds:
            </p>
            <div class="highlight-default notranslate">
             <div class="highlight">
              <pre><span></span><span class="n">fold</span><span class="p">(</span><span class="n">unfold</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span> <span class="o">==</span> <span class="n">divisor</span> <span class="o">*</span> <span class="nb">input</span>
</pre>
             </div>
            </div>
            <p>
             where
             <code class="docutils literal notranslate">
              <span class="pre">
               divisor
              </span>
             </code>
             is a tensor that depends only on the shape
and dtype of the
             <code class="docutils literal notranslate">
              <span class="pre">
               input
              </span>
             </code>
             :
            </p>
            <div class="doctest highlight-default notranslate">
             <div class="highlight">
              <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_ones</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">input</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor</span> <span class="o">=</span> <span class="n">fold</span><span class="p">(</span><span class="n">unfold</span><span class="p">(</span><span class="n">input_ones</span><span class="p">))</span>
</pre>
             </div>
            </div>
            <p>
             When the
             <code class="docutils literal notranslate">
              <span class="pre">
               divisor
              </span>
             </code>
             tensor contains no zero elements, then
             <code class="docutils literal notranslate">
              <span class="pre">
               fold
              </span>
             </code>
             and
             <code class="docutils literal notranslate">
              <span class="pre">
               unfold
              </span>
             </code>
             operations are inverses of each
other (up to constant divisor).
            </p>
           </div>
           <div class="admonition warning">
            <p class="admonition-title">
             Warning
            </p>
            <p>
             Currently, only unbatched (3D) or batched (4D) image-like output tensors are supported.
            </p>
           </div>
           <dl class="simple">
            <dt>
             Shape:
            </dt>
            <dd>
             <ul class="simple">
              <li>
               <p>
                Input:
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       N
                      </mi>
                      <mo separator="true">
                       ,
                      </mo>
                      <mi>
                       C
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mo>
                       ∏
                      </mo>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mtext>
                       kernel_size
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mi>
                       L
                      </mi>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (N, C \times \prod(\text{kernel\_size}), L)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.10903em;">
                     N
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.07153em;">
                     C
                    </span>
                    <span class="mspace" style="margin-right:0.2222em;">
                    </span>
                    <span class="mbin">
                     ×
                    </span>
                    <span class="mspace" style="margin-right:0.2222em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                    </span>
                    <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                     ∏
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      kernel_size
                     </span>
                    </span>
                    <span class="mclose">
                     )
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord mathnormal">
                     L
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                or
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       C
                      </mi>
                      <mo>
                       ×
                      </mo>
                      <mo>
                       ∏
                      </mo>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mtext>
                       kernel_size
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mi>
                       L
                      </mi>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (C \times \prod(\text{kernel\_size}), L)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1em;vertical-align:-0.25em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.07153em;">
                     C
                    </span>
                    <span class="mspace" style="margin-right:0.2222em;">
                    </span>
                    <span class="mbin">
                     ×
                    </span>
                    <span class="mspace" style="margin-right:0.2222em;">
                    </span>
                   </span>
                   <span class="base">
                    <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                    </span>
                    <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                     ∏
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      kernel_size
                     </span>
                    </span>
                    <span class="mclose">
                     )
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord mathnormal">
                     L
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </p>
              </li>
              <li>
               <p>
                Output:
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       N
                      </mi>
                      <mo separator="true">
                       ,
                      </mo>
                      <mi>
                       C
                      </mi>
                      <mo separator="true">
                       ,
                      </mo>
                      <mtext>
                       output_size
                      </mtext>
                      <mo stretchy="false">
                       [
                      </mo>
                      <mn>
                       0
                      </mn>
                      <mo stretchy="false">
                       ]
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mtext>
                       output_size
                      </mtext>
                      <mo stretchy="false">
                       [
                      </mo>
                      <mn>
                       1
                      </mn>
                      <mo stretchy="false">
                       ]
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mo>
                       …
                      </mo>
                      <mtext>
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (N, C, \text{output\_size}[0], \text{output\_size}[1], \dots)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.10903em;">
                     N
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.07153em;">
                     C
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      output_size
                     </span>
                    </span>
                    <span class="mopen">
                     [
                    </span>
                    <span class="mord">
                     0
                    </span>
                    <span class="mclose">
                     ]
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      output_size
                     </span>
                    </span>
                    <span class="mopen">
                     [
                    </span>
                    <span class="mord">
                     1
                    </span>
                    <span class="mclose">
                     ]
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="minner">
                     …
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                or
                <span class="math">
                 <span class="katex">
                  <span class="katex-mathml">
                   <math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                     <mrow>
                      <mo stretchy="false">
                       (
                      </mo>
                      <mi>
                       C
                      </mi>
                      <mo separator="true">
                       ,
                      </mo>
                      <mtext>
                       output_size
                      </mtext>
                      <mo stretchy="false">
                       [
                      </mo>
                      <mn>
                       0
                      </mn>
                      <mo stretchy="false">
                       ]
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mtext>
                       output_size
                      </mtext>
                      <mo stretchy="false">
                       [
                      </mo>
                      <mn>
                       1
                      </mn>
                      <mo stretchy="false">
                       ]
                      </mo>
                      <mo separator="true">
                       ,
                      </mo>
                      <mo>
                       …
                      </mo>
                      <mtext>
                      </mtext>
                      <mo stretchy="false">
                       )
                      </mo>
                     </mrow>
                     <annotation encoding="application/x-tex">
                      (C, \text{output\_size}[0], \text{output\_size}[1], \dots)
                     </annotation>
                    </semantics>
                   </math>
                  </span>
                  <span aria-hidden="true" class="katex-html">
                   <span class="base">
                    <span class="strut" style="height:1.06em;vertical-align:-0.31em;">
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathnormal" style="margin-right:0.07153em;">
                     C
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      output_size
                     </span>
                    </span>
                    <span class="mopen">
                     [
                    </span>
                    <span class="mord">
                     0
                    </span>
                    <span class="mclose">
                     ]
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mord text">
                     <span class="mord">
                      output_size
                     </span>
                    </span>
                    <span class="mopen">
                     [
                    </span>
                    <span class="mord">
                     1
                    </span>
                    <span class="mclose">
                     ]
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="minner">
                     …
                    </span>
                    <span class="mspace" style="margin-right:0.1667em;">
                    </span>
                    <span class="mclose">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                as described above
               </p>
              </li>
             </ul>
            </dd>
           </dl>
           <p>
            Examples:
           </p>
           <div class="highlight-default notranslate">
            <div class="highlight">
             <pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fold</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Fold</span><span class="p">(</span><span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">fold</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">torch.Size([1, 3, 4, 5])</span>
</pre>
            </div>
           </div>
          </dd>
         </dl>
        </div>
       </article>
      </div>
     </div>
    </div>
   </section>
  </div>
 </body>
</html>